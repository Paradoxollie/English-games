<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RMCQTMKDVP"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-RMCQTMKDVP');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="English Quest Leaderboard - Compare your scores with other players">
    <title>English Quest - Leaderboard</title>
    
    <!-- Polices -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link href="./dist/output.css" rel="stylesheet">
    <link href="./src/styles/layout.css" rel="stylesheet">
    <link href="./src/styles/fonts.css" rel="stylesheet">
    <link href="./src/styles/transitions.css" rel="stylesheet">
    <link href="./src/styles/colors.css" rel="stylesheet">
    <link href="./src/styles/navigation.css" rel="stylesheet">
    <link href="./src/styles/leaderboard.css" rel="stylesheet">
    <link href="./src/styles/visitor-counter.css" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="./favicon.ico">

    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-analytics.js"></script>
</head>
<body class="bg-quest-pattern" data-page="leaderboard" style="background-image: url('./images/background.webp');">
    <!-- Header -->
    <header class="site-header">
        <div class="logo-container">
            <img src="./images/logo.gif" alt="English Quest Logo" class="w-64 h-auto">
        </div>

        <nav class="main-nav">
            <div class="container mx-auto px-4 py-3 flex items-center justify-center space-x-8">
                <a href="index.html" class="nav-link">Home</a>
                <a href="./all-games.html" class="nav-link">Games</a>
                <a href="./courses.html" class="nav-link">Courses</a>
                <a href="./leaderboard.html" class="nav-link active text-quest-red font-bold hover:text-quest-red relative glow-red">Leaderboard</a>
                <a href="./contact.html" class="nav-link">Contact</a>
            </div>
        </nav>
    </header>

    <main class="min-h-screen pt-32 pb-32">
        <!-- Hero Section -->
        <div class="quest-panel max-w-2xl mx-auto mb-16 text-center">
            <h1 class="text-5xl font-bold mb-6 glow-text">
                <span class="text-white">HALL OF</span>
                <span class="text-quest-red">CHAMPIONS</span>
            </h1>
            <p class="text-xl text-gray-300 font-medieval italic">
                "Where Legends Rise and Heroes are Eternal"
            </p>
        </div>

        <!-- Leaderboard Section -->
        <div class="quest-panel max-w-7xl mx-auto mb-16">
            <!-- Speed Verb Challenge -->
            <div class="game-section w-full">
                <div class="text-center">
                    <h2 class="game-title">
                        <span class="game-icon">‚öîÔ∏è</span>
                        Speed Verb Challenge
                        <span class="game-icon">‚öîÔ∏è</span>
                    </h2>
                </div>
                <div class="w-full">
                    <table class="podium-table w-full">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Champion</th>
                                <th>Score</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody id="speed-verb-leaderboard">
                            <!-- Rempli dynamiquement -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Word Memory Game -->
            <div class="game-section w-full">
                <h2 class="game-title">
                    <span class="game-icon">üéØ</span>
                    Word Memory Game
                    <span class="game-icon">üéØ</span>
                </h2>
                <div class="w-full">
                    <table class="podium-table w-full">
                        <thead>
                            <tr>
                                <th>RANK</th>
                                <th>CHAMPION</th>
                                <th>SCORE</th>
                                <th>DATE</th>
                            </tr>
                        </thead>
                        <tbody id="memory-game-leaderboard"></tbody>
                    </table>
                </div>
            </div>

            <!-- Memory Matrix -->
            <div class="game-section w-full">
                <h2 class="game-title">
                    <span class="game-icon">üß©</span>
                    Memory Matrix
                    <span class="game-icon">üß©</span>
                </h2>
                <div class="w-full">
                    <table class="podium-table w-full">
                        <thead>
                            <tr>
                                <th>RANK</th>
                                <th>CHAMPION</th>
                                <th>SCORE</th>
                                <th>DATE</th>
                            </tr>
                        </thead>
                        <tbody id="matrix-game-leaderboard"></tbody>
                    </table>
                </div>
            </div>

            <!-- Lost in Migration -->
            <div class="game-section w-full">
                <h2 class="game-title">
                    <span class="game-icon">ü¶Ö</span>
                    Lost in Migration
                    <span class="game-icon">ü¶Ö</span>
                </h2>
                <div class="w-full">
                    <table class="podium-table w-full">
                        <thead>
                            <tr>
                                <th>RANK</th>
                                <th>CHAMPION</th>
                                <th>SCORE</th>
                                <th>DATE</th>
                            </tr>
                        </thead>
                        <tbody id="migration-leaderboard"></tbody>
                    </table>
                </div>
            </div>

            <!-- Brew Your Words -->
            <div class="game-section w-full">
                <h2 class="game-title">
                    <span class="game-icon">üß™</span>
                    Brew Your Words
                    <span class="game-icon">üß™</span>
                </h2>
                <div class="w-full">
                    <table class="podium-table w-full">
                        <thead>
                            <tr>
                                <th>RANK</th>
                                <th>CHAMPION</th>
                                <th>SCORE</th>
                                <th>DATE</th>
                            </tr>
                        </thead>
                        <tbody id="brew-words-leaderboard"></tbody>
                    </table>
                </div>
            </div>

            <!-- Whisper Trials -->
            <div class="game-section w-full">
                <h2 class="game-title">
                    <span class="game-icon">üé≠</span>
                    Whisper Trials
                    <span class="game-icon">üé≠</span>
                </h2>
                <div class="w-full">
                    <table class="podium-table w-full">
                        <thead>
                            <tr>
                                <th>RANK</th>
                                <th>CHAMPION</th>
                                <th>SCORE</th>
                                <th>DATE</th>
                            </tr>
                        </thead>
                        <tbody id="whisper-trials-leaderboard"></tbody>
                    </table>
                </div>
            </div>

            <!-- Word Bubbles -->
            <div class="game-section w-full">
                <h2 class="game-title">
                    <span class="game-icon">ü´ß</span>
                    Word Bubbles
                    <span class="game-icon">ü´ß</span>
                </h2>
                <div class="w-full">
                    <table class="podium-table w-full">
                        <thead>
                            <tr>
                                <th>RANK</th>
                                <th>CHAMPION</th>
                                <th>SCORE</th>
                                <th>DATE</th>
                            </tr>
                        </thead>
                        <tbody id="word-bubbles-leaderboard"></tbody>
                    </table>
                </div>
            </div>

            <!-- Echoes of Lexicon -->
            <div class="game-section w-full">
                <h2 class="game-title">
                    <span class="game-icon">üìö</span>
                    Echoes of Lexicon
                    <span class="game-icon">üìö</span>
                </h2>
                <div class="w-full">
                    <table class="podium-table w-full">
                        <thead>
                            <tr>
                                <th>RANK</th>
                                <th>CHAMPION</th>
                                <th>SCORE</th>
                                <th>DATE</th>
                            </tr>
                        </thead>
                        <tbody id="echoes-lexicon-leaderboard"></tbody>
                    </table>
                </div>
            </div>

            <!-- Enigma Scroll -->
            <div class="game-section w-full">
                <h2 class="game-title">
                    <span class="game-icon">üìú</span>
                    Enigma Scroll
                    <span class="game-icon">üìú</span>
                </h2>
                <div class="w-full">
                    <table class="podium-table w-full">
                        <thead>
                            <tr>
                                <th>RANK</th>
                                <th>CHAMPION</th>
                                <th>SCORE</th>
                                <th>DATE</th>
                            </tr>
                        </thead>
                        <tbody id="enigma-scroll-leaderboard"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer correct -->
    <footer class="quest-footer">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-quest-gold text-lg font-medieval mb-4">About Us</h3>
                    <p class="text-gray-300">
                        English Quest is dedicated to making language learning fun and effective through interactive games.
                    </p>
                </div>
                <div>
                    <h3 class="text-quest-gold text-lg font-medieval mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="./index.html" class="footer-link">Home</a></li>
                        <li><a href="./all-games.html" class="footer-link">All Games</a></li>
                        <li><a href="./courses.html" class="footer-link">Courses</a></li>
                        <li><a href="./contact.html" class="footer-link">Contact Us</a></li>
                    </ul>
                    </div>
                <div>
                    <h3 class="text-quest-gold text-lg font-medieval mb-4">Stats</h3>
                    <ul class="space-y-2">
                        <div class="visitor-counter text-left mb-4">
                            <div id="visitor-count" class="counter-wrapper">
                                <div class="counter-loading">
                                    <span class="text-quest-gold">Loading visitor stats...</span>
                                </div>
                            </div>
                        </div>
                    </ul>
                </div>
            </div>
           
            <div class="mt-8 pt-8 border-t border-quest-gold/30 text-center">
                <p class="text-gray-400">&copy; 2024 - English Quest - Pierre Marienne - All rights reserved </p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // Configuration Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAm_fvXFh9Iv1EkoCJniaLkmXOelC6CRv0",
            authDomain: "english-games-41017.firebaseapp.com",
            projectId: "english-games-41017",
            storageBucket: "english-games-41017.appspot.com",
            messagingSenderId: "452279652544",
            appId: "1:452279652544:web:916f93e0ab29183e739d25",
            measurementId: "G-RMCQTMKDVP"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const analytics = firebase.analytics();

        // Fonction pour charger les scores d'un jeu sp√©cifique
        function loadGameScores(collectionName, tableId) {
            console.log(`Loading scores for ${collectionName}`);
            db.collection(collectionName)
                .orderBy("score", "desc")
                .limit(3)
                .get()
                .then((querySnapshot) => {
                    const tableBody = document.getElementById(tableId);
                    tableBody.innerHTML = "";
                    let rank = 1;
                    querySnapshot.forEach((doc) => {
                        const row = document.createElement('tr');
                        row.className = `rank-${rank}`;
                        
                        const date = doc.data().timestamp ? 
                            new Date(doc.data().timestamp.seconds * 1000).toLocaleDateString() : 
                            'N/A';
                        
                        row.innerHTML = `
                            <td class="rank">${rank}</td>
                            <td>${doc.data().name || 'Anonymous'}</td>
                            <td class="score">${doc.data().score}</td>
                            <td>${date}</td>
                        `;
                        tableBody.appendChild(row);
                        rank++;
                    });
                })
                .catch((error) => {
                    console.error(`Error loading ${collectionName} scores:`, error);
                });
        }

        // Chargement des scores au chargement de la page
        document.addEventListener('DOMContentLoaded', (event) => {
            console.log("DOM fully loaded, loading scores...");
            loadGameScores("speed_verb_scores", "speed-verb-leaderboard");
            loadGameScores("word_memory_game_scores", "memory-game-leaderboard");
            loadGameScores("memory_matrix_scores", "matrix-game-leaderboard");
            loadGameScores("lost_in_migration_scores", "migration-leaderboard");
            loadGameScores("brewYourWordsScores", "brew-words-leaderboard");
            loadGameScores("enigma_scroll_scores", "enigma-scroll-leaderboard");
            loadGameScores("whisper_trials_scores", "whisper-trials-leaderboard");
            loadGameScores("word_bubbles_scores", "word-bubbles-leaderboard");
            loadGameScores("echoes_lexicon_scores", "echoes-lexicon-leaderboard");
        });
    </script>
    <script src="./visit-counter.js"></script>
</body>
</html>
