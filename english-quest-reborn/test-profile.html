<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Profile - English Quest</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 10px; border: 1px solid #ccc; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>Test Profile Functionality</h1>
    
    <div class="test-section">
        <h2>Authentication Test</h2>
        <div id="auth-status">Testing...</div>
    </div>
    
    <div class="test-section">
        <h2>Skin Service Test</h2>
        <div id="skin-status">Testing...</div>
    </div>
    
    <div class="test-section">
        <h2>Avatar Display Test</h2>
        <div id="avatar-container" style="width: 200px; height: 300px; border: 1px solid #000; position: relative;">
            <img id="avatar-head" src="" alt="Head" style="position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 80px;">
            <img id="avatar-body" src="" alt="Body" style="position: absolute; top: 60px; left: 50%; transform: translateX(-50%); width: 100px;">
        </div>
    </div>

    <script src="scripts/lib/bcrypt.min.js"></script>
    <script type="module">
        import { authService } from './scripts/auth-service.js';
        import { skinService } from './scripts/skin-service.js';

        async function testAuth() {
            try {
                await authService.init();
                const user = authService.getCurrentUser();
                
                if (user) {
                    document.getElementById('auth-status').innerHTML = `<span class="success">✓ User authenticated: ${user.username}</span>`;
                    return user;
                } else {
                    document.getElementById('auth-status').innerHTML = `<span class="error">✗ No user authenticated</span>`;
                    return null;
                }
            } catch (error) {
                document.getElementById('auth-status').innerHTML = `<span class="error">✗ Auth error: ${error.message}</span>`;
                return null;
            }
        }

        function testSkinService() {
            try {
                const skins = skinService.getAvailableSkins();
                const headCount = skins.head?.length || 0;
                const bodyCount = skins.body?.length || 0;
                
                document.getElementById('skin-status').innerHTML = `<span class="success">✓ Skins loaded: ${headCount} heads, ${bodyCount} bodies</span>`;
                
                // Test avatar display
                if (headCount > 0 && bodyCount > 0) {
                    document.getElementById('avatar-head').src = skins.head[0].image;
                    document.getElementById('avatar-body').src = skins.body[0].image;
                }
                
                return true;
            } catch (error) {
                document.getElementById('skin-status').innerHTML = `<span class="error">✗ Skin service error: ${error.message}</span>`;
                return false;
            }
        }

        // Run tests
        async function runTests() {
            const user = await testAuth();
            testSkinService();
        }

        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html> 