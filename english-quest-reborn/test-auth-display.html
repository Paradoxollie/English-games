<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Affichage Authentification - English Quest</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Exo+2:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/new-design.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container header-container">
      <a href="index.html" class="logo">ENGLISH<span>QUEST</span></a>

      <nav class="nav">
        <ul class="nav-list">
          <li><a href="index.html" class="nav-link">Accueil</a></li>
          <li><a href="games.html" class="nav-link">Jeux</a></li>
          <li><a href="courses.html" class="nav-link">Cours</a></li>
          <li><a href="gallery.html" class="nav-link">Galerie</a></li>
          <li><a href="leaderboard.html" class="nav-link active">Test</a></li>
        </ul>
      </nav>

      <div class="user-menu" id="userMenu">
        <a href="login.html" class="btn-login" id="loginButton">Connexion</a>
        <a href="profile.html" class="btn-login" id="profileButton" style="display: none;">Mon Profil</a>
        <button class="menu-toggle">‚ò∞</button>
      </div>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero" style="background: linear-gradient(135deg, rgba(18, 18, 18, 0.7), rgba(30, 30, 30, 0.6)), url('assets/images/background.jpg'); background-size: cover; background-position: center top; background-repeat: no-repeat; position: relative;">
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at center, rgba(46, 204, 113, 0.1) 0%, transparent 70%); pointer-events: none;"></div>
    <div class="container hero-content">
      <h1 class="hero-title">
        <span class="text-gradient">TEST AUTHENTIFICATION</span>
      </h1>
      <p class="hero-subtitle">V√©rification de l'affichage du nom d'utilisateur</p>
    </div>
  </section>

  <!-- Test Section -->
  <section class="section" style="background-color: #1a1a1a; padding-top: 5rem; padding-bottom: 5rem;">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title text-gradient">Informations d'authentification</h2>
        <p class="section-subtitle">V√©rification du syst√®me d'affichage du nom d'utilisateur</p>
      </div>

      <div style="background: var(--color-surface); border-radius: var(--border-radius-lg); padding: 2rem; margin: 2rem 0;">
        <h3 style="color: var(--color-primary); margin-bottom: 1rem;">√âtat actuel</h3>
        <div id="auth-status" style="color: var(--color-text-primary); margin-bottom: 1rem;">
          Chargement...
        </div>
        
        <h3 style="color: var(--color-primary); margin-bottom: 1rem;">Donn√©es localStorage</h3>
        <div id="storage-info" style="color: var(--color-text-secondary); font-family: monospace; white-space: pre-wrap; background: var(--color-background); padding: 1rem; border-radius: var(--border-radius-md); margin-bottom: 1rem;">
          Chargement...
        </div>
        
        <h3 style="color: var(--color-primary); margin-bottom: 1rem;">Actions de test</h3>
        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
          <button onclick="testAuthHeader()" class="btn-login">Tester Auth Header</button>
          <button onclick="showStorageDetails()" class="btn-login">D√©tails Storage</button>
          <button onclick="forceRefresh()" class="btn-login">Forcer Refresh</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer" style="background-color: var(--color-surface); padding: var(--spacing-xl) 0; border-top: 1px solid rgba(255, 255, 255, 0.1);">
    <div class="container">
      <div class="footer-content" style="text-align: center;">
        <p style="color: var(--color-text-secondary);">Page de test pour l'authentification - English Quest</p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="scripts/new-design.js"></script>
  <script type="module" src="scripts/auth-header.js"></script>
  <script>
    // Fonctions de test
    async function testAuthHeader() {
      console.log('üß™ Test manuel du header d\'authentification');
      
      if (window.initAuthHeader) {
        await window.initAuthHeader();
        updateAuthStatus();
      } else {
        console.error('‚ùå Fonction initAuthHeader non disponible');
      }
    }
    
    function showStorageDetails() {
      const keys = [
        'english_quest_current_user',
        'currentUser',
        'englishQuestUserId',
        'users',
        'english_quest_users'
      ];
      
      let details = 'D√©tails du localStorage:\n\n';
      
      keys.forEach(key => {
        const value = localStorage.getItem(key);
        details += `${key}: ${value ? 'PR√âSENT' : 'ABSENT'}\n`;
        if (value) {
          try {
            const parsed = JSON.parse(value);
            if (parsed.username) {
              details += `  ‚Üí username: "${parsed.username}"\n`;
            }
            if (parsed.displayName) {
              details += `  ‚Üí displayName: "${parsed.displayName}"\n`;
            }
          } catch (e) {
            details += `  ‚Üí valeur: "${value.substring(0, 50)}..."\n`;
          }
        }
        details += '\n';
      });
      
      document.getElementById('storage-info').textContent = details;
    }
    
    function forceRefresh() {
      console.log('üîÑ Rechargement forc√© de la page');
      window.location.reload();
    }
    
    function updateAuthStatus() {
      const loginBtn = document.getElementById('loginButton');
      const profileBtn = document.getElementById('profileButton');
      
      let status = '√âtat des boutons:\n';
      status += `- Bouton connexion: ${loginBtn ? (loginBtn.style.display === 'none' ? 'MASQU√â' : 'VISIBLE') : 'NON TROUV√â'}\n`;
      status += `- Bouton profil: ${profileBtn ? (profileBtn.style.display === 'none' ? 'MASQU√â' : 'VISIBLE') : 'NON TROUV√â'}\n`;
      
      if (profileBtn && profileBtn.style.display !== 'none') {
        status += `- Texte du profil: "${profileBtn.textContent}"\n`;
      }
      
      const logoutBtn = document.getElementById('logoutButton');
      status += `- Bouton d√©connexion: ${logoutBtn ? 'PR√âSENT' : 'ABSENT'}\n`;
      
      document.getElementById('auth-status').textContent = status;
    }
    
    // Mise √† jour automatique toutes les 2 secondes
    setInterval(updateAuthStatus, 2000);
    
    // Mise √† jour initiale
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(() => {
        updateAuthStatus();
        showStorageDetails();
      }, 1000);
    });
  </script>
</body>
</html> 