/**
 * English Quest - Game Avatar Styles MOBILE-FIRST
 * Système ultra-intégré pour mobile et desktop
 */

/* ===========================================
   VARIABLES RESPONSIVE MOBILE-FIRST
   =========================================== */

:root {
  /* Tailles mobile-first */
  --mobile-avatar-size: min(25vw, 120px);
  --tablet-avatar-size: min(20vw, 150px);
  --desktop-avatar-size: min(15vw, 180px);
  
  /* Positions adaptatives */
  --mobile-top: 15px;
  --mobile-right: 15px;
  --tablet-top: 20px;
  --tablet-right: 20px;
}

/* ===========================================
   MINI-AVATAR MOBILE-FIRST DESIGN
   =========================================== */

.game-mini-avatar {
  /* Mobile par défaut */
  position: fixed;
  top: var(--mobile-top);
  right: var(--mobile-right);
  z-index: 1500;
  
  /* Design mobile optimisé */
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(30, 30, 30, 0.95));
  border: 3px solid var(--color-primary, #2ecc71);
  border-radius: 20px;
  padding: 8px;
  
  /* Effets visuels */
  backdrop-filter: blur(15px);
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.4),
    0 0 20px rgba(46, 204, 113, 0.2);
  
  /* Taille responsive */
  width: var(--mobile-avatar-size);
  min-width: 100px;
  max-width: 200px;
  
  /* Animations fluides */
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  
  /* Mode tactile optimisé */
  touch-action: none;
  user-select: none;
}

/* États interactifs mobile */
.game-mini-avatar:active {
  transform: scale(0.95);
  transition: transform 0.1s ease;
}

.game-mini-avatar:hover {
  transform: scale(1.08);
  box-shadow: 
    0 12px 40px rgba(0, 0, 0, 0.5),
    0 0 30px rgba(46, 204, 113, 0.4);
  border-color: var(--color-secondary, #3498db);
}

/* ===========================================
   AVATAR DISPLAY RESPONSIVE - CORRECTION DÉFINITIVE
   =========================================== */

.mini-avatar-display {
  /* Tailles fluides */
  --avatar-size: calc(var(--mobile-avatar-size) - 16px);
  --head-size: calc(var(--avatar-size) * 0.45);
  --body-size: calc(var(--avatar-size) * 0.65);
  --accessory-size: calc(var(--avatar-size) * 0.3);
  
  width: var(--avatar-size);
  height: calc(var(--avatar-size) * 1.1);
  position: relative;
  margin: 0 auto 8px;
  border-radius: 15px;
  overflow: visible;
}

/* Background en arrière-plan */
.mini-avatar-display .avatar-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 1;
  border-radius: 15px;
  opacity: 0.3;
  display: block !important;
}

/* Corps positionné en bas */
.mini-avatar-display .avatar-body,
.mini-avatar-display #gameMiniAvatarBody {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: var(--body-size);
  height: auto;
  object-fit: contain;
  z-index: 5;
  transition: all 0.3s ease;
}

/* Tête COLLÉE au corps - CORRECTION ULTRA PRÉCISE */
.mini-avatar-display .avatar-head,
.mini-avatar-display #gameMiniAvatarHead {
  position: absolute;
  bottom: calc(var(--body-size) * 0.70); /* AUGMENTÉ pour coller vraiment */
  left: 50%;
  transform: translateX(-50%);
  width: var(--head-size);
  height: auto;
  object-fit: contain;
  z-index: 10;
  transition: all 0.3s ease;
  margin-bottom: -2px; /* Force le collage */
}

/* Accessoire BIEN VISIBLE en haut à droite */
.mini-avatar-display .avatar-accessory,
.mini-avatar-display #gameMiniAvatarAccessory {
  position: absolute;
  top: 2%;
  right: 2%;
  width: var(--accessory-size);
  height: var(--accessory-size);
  z-index: 15;
  transition: all 0.3s ease;
  /* Effet de brillance pour le rendre plus visible */
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.6));
}

.mini-avatar-display .avatar-accessory img,
.mini-avatar-display #gameMiniAvatarAccessory img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  /* Optimisation pour GIF */
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
  /* Animation subtile pour attirer l'attention */
  animation: accessoryGlow 3s ease-in-out infinite;
}

@keyframes accessoryGlow {
  0%, 100% { 
    filter: brightness(1) drop-shadow(0 0 5px rgba(255, 255, 255, 0.3)); 
  }
  50% { 
    filter: brightness(1.2) drop-shadow(0 0 10px rgba(255, 255, 255, 0.6)); 
  }
}

/* ===========================================
   INFORMATIONS UTILISATEUR MOBILE
   =========================================== */

.mini-avatar-info {
  text-align: center;
  margin-bottom: 6px;
  padding: 0 4px;
}

.mini-avatar-name {
  color: var(--color-primary, #2ecc71);
  font-weight: 700;
  font-size: clamp(0.7rem, 3vw, 0.9rem);
  margin-bottom: 2px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  letter-spacing: 0.5px;
}

.mini-avatar-level {
  color: rgba(255, 255, 255, 0.9);
  font-size: clamp(0.6rem, 2.5vw, 0.8rem);
  margin-bottom: 4px;
  font-weight: 500;
}

/* Barre d'XP mobile optimisée */
.mini-avatar-xp-bar {
  width: 100%;
  height: 8px;
  background: rgba(255, 255, 255, 0.15);
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.mini-avatar-xp-bar .xp-fill {
  height: 100%;
  background: linear-gradient(90deg, 
    var(--color-primary, #2ecc71), 
    var(--color-secondary, #3498db),
    var(--color-accent, #f1c40f)
  );
  border-radius: 4px;
  transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  box-shadow: 0 0 10px rgba(46, 204, 113, 0.5);
}

.mini-avatar-xp-bar .xp-fill::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, 
    transparent, 
    rgba(255, 255, 255, 0.4), 
    transparent
  );
  animation: xpShimmer 3s ease-in-out infinite;
}

@keyframes xpShimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

/* ===========================================
   STATUT ET RÉACTIONS MOBILE
   =========================================== */

.mini-avatar-status {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  min-height: 20px;
  flex-wrap: wrap;
}

.status-indicator {
  width: 14px;
  height: 14px;
  border-radius: 50%;
  transition: all 0.4s ease;
  font-size: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid rgba(255, 255, 255, 0.2);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

/* États du statut avec plus d'impact visuel */
.status-indicator.idle {
  background: linear-gradient(45deg, #95a5a6, #7f8c8d);
  animation: pulse 3s ease-in-out infinite;
  box-shadow: 0 0 15px rgba(149, 165, 166, 0.5);
}

.status-indicator.thinking {
  background: linear-gradient(45deg, var(--color-warning, #f39c12), #e67e22);
  animation: thinkingPulse 1.5s ease-in-out infinite;
  box-shadow: 0 0 20px rgba(243, 156, 18, 0.6);
}

.status-indicator.happy {
  background: linear-gradient(45deg, var(--color-primary, #2ecc71), #27ae60);
  animation: happyBounce 0.8s ease-in-out 4;
  box-shadow: 0 0 25px rgba(46, 204, 113, 0.7);
}

.status-indicator.sad {
  background: linear-gradient(45deg, var(--color-danger, #e74c3c), #c0392b);
  animation: sadShake 0.6s ease-in-out 3;
  box-shadow: 0 0 20px rgba(231, 76, 60, 0.6);
}

.status-indicator.excited {
  background: linear-gradient(45deg, var(--color-secondary, #3498db), #2980b9);
  animation: excitedSpin 1s ease-in-out 3;
  box-shadow: 0 0 30px rgba(52, 152, 219, 0.8);
}

/* Animations améliorées */
@keyframes pulse {
  0%, 100% { opacity: 0.7; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.3); }
}

@keyframes thinkingPulse {
  0%, 100% { opacity: 0.8; transform: scale(1) rotate(0deg); }
  50% { opacity: 1; transform: scale(1.2) rotate(5deg); }
}

@keyframes happyBounce {
  0%, 100% { transform: scale(1) translateY(0); }
  50% { transform: scale(1.5) translateY(-3px); }
}

@keyframes sadShake {
  0%, 100% { transform: translateX(0) scale(1); }
  25% { transform: translateX(-4px) scale(0.9); }
  75% { transform: translateX(4px) scale(0.9); }
}

@keyframes excitedSpin {
  0% { transform: rotate(0deg) scale(1); }
  25% { transform: rotate(90deg) scale(1.3); }
  50% { transform: rotate(180deg) scale(1.5); }
  75% { transform: rotate(270deg) scale(1.3); }
  100% { transform: rotate(360deg) scale(1); }
}

/* Texte de réaction mobile optimisé */
.reaction-text {
  color: white;
  font-size: clamp(0.65rem, 2.5vw, 0.8rem);
  font-weight: 700;
  opacity: 0;
  transform: translateY(10px);
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  
  background: linear-gradient(135deg, 
    rgba(0, 0, 0, 0.9), 
    rgba(30, 30, 30, 0.9)
  );
  padding: 6px 10px;
  border-radius: 15px;
  border: 1px solid var(--color-primary, #2ecc71);
  
  white-space: nowrap;
  max-width: calc(100vw - 40px);
  overflow: hidden;
  text-overflow: ellipsis;
  
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
}

.reaction-text.show {
  opacity: 1;
  transform: translateY(0);
  animation: reactionPop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes reactionPop {
  0% { 
    transform: translateY(15px) scale(0.7); 
    opacity: 0; 
  }
  60% { 
    transform: translateY(-8px) scale(1.1); 
    opacity: 1; 
  }
  100% { 
    transform: translateY(0) scale(1); 
    opacity: 1; 
  }
}

/* ===========================================
   RESPONSIVE BREAKPOINTS
   =========================================== */

/* Tablettes */
@media (min-width: 768px) {
  .game-mini-avatar {
    top: var(--tablet-top);
    right: var(--tablet-right);
    width: var(--tablet-avatar-size);
    padding: 12px;
    border-radius: 25px;
  }
  
  .mini-avatar-display {
    --avatar-size: calc(var(--tablet-avatar-size) - 24px);
  }
  
  .reaction-text {
    max-width: 150px;
  }
}

/* Desktop */
@media (min-width: 1024px) {
  .game-mini-avatar {
    width: var(--desktop-avatar-size);
    padding: 15px;
    border-radius: 30px;
  }
  
  .mini-avatar-display {
    --avatar-size: calc(var(--desktop-avatar-size) - 30px);
  }
  
  .reaction-text {
    max-width: 200px;
  }
}

/* Mode paysage mobile */
@media (max-width: 768px) and (orientation: landscape) {
  .game-mini-avatar {
    top: 8px;
    right: 8px;
    width: min(20vh, 100px);
    padding: 6px;
  }
  
  .mini-avatar-display {
    --avatar-size: calc(min(20vh, 100px) - 12px);
  }
  
  .mini-avatar-info {
    margin-bottom: 3px;
  }
  
  .mini-avatar-name {
    font-size: 0.65rem;
  }
  
  .mini-avatar-level {
    font-size: 0.55rem;
  }
  
  .mini-avatar-xp-bar {
    height: 6px;
  }
}

/* Très petits écrans */
@media (max-width: 480px) {
  .game-mini-avatar {
    top: 10px;
    right: 10px;
    width: min(30vw, 110px);
    padding: 6px;
  }
  
  .status-indicator {
    width: 12px;
    height: 12px;
  }
}

/* ===========================================
   MODES SPÉCIAUX POUR INTÉGRATION COURS/JEUX
   =========================================== */

/* Mode intégré dans le contenu */
.game-mini-avatar.integrated {
  position: static;
  width: 100%;
  max-width: 300px;
  margin: 0 auto 20px;
  border-radius: 20px;
  padding: 20px;
  background: linear-gradient(135deg, 
    rgba(46, 204, 113, 0.1), 
    rgba(52, 152, 219, 0.1)
  );
  border: 2px solid var(--color-primary, #2ecc71);
}

/* Mode leçon - avatar plus grand et informatif */
.game-mini-avatar.lesson-mode {
  position: relative;
  width: 100%;
  max-width: 250px;
  margin: 15px auto;
  padding: 15px;
  border-radius: 25px;
  background: linear-gradient(135deg, 
    rgba(0, 0, 0, 0.8), 
    rgba(30, 30, 30, 0.8)
  );
}

.lesson-mode .mini-avatar-display {
  --avatar-size: 120px;
}

.lesson-mode .mini-avatar-info {
  margin-bottom: 15px;
}

.lesson-mode .mini-avatar-name {
  font-size: 1.2rem;
  margin-bottom: 8px;
}

.lesson-mode .mini-avatar-level {
  font-size: 1rem;
  margin-bottom: 10px;
}

.lesson-mode .mini-avatar-xp-bar {
  height: 12px;
  margin-bottom: 10px;
}

/* ===========================================
   ACCESSIBILITÉ ET PERFORMANCES
   =========================================== */

/* Mode contraste élevé */
@media (prefers-contrast: high) {
  .game-mini-avatar {
    border-width: 4px;
    background: #000000;
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
  }
  
  .mini-avatar-name,
  .mini-avatar-level,
  .reaction-text {
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 1);
    font-weight: 900;
  }
}

/* Mouvement réduit */
@media (prefers-reduced-motion: reduce) {
  .game-mini-avatar,
  .game-mini-avatar *,
  .status-indicator,
  .reaction-text {
    animation-duration: 0.1s !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.1s !important;
  }
}

/* Optimisations performances */
.game-mini-avatar,
.game-mini-avatar * {
  backface-visibility: hidden;
  perspective: 1000px;
  will-change: transform;
}

/* ===========================================
   THÈMES ADAPTATIFS PAR JEU
   =========================================== */

/* Thème Enigma Scroll */
body[data-game="enigma-scroll"] .game-mini-avatar {
  border-color: #9b59b6;
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.4),
    0 0 20px rgba(155, 89, 182, 0.3);
}

body[data-game="enigma-scroll"] .mini-avatar-name {
  color: #9b59b6;
}

body[data-game="enigma-scroll"] .mini-avatar-xp-bar .xp-fill {
  background: linear-gradient(90deg, #9b59b6, #8e44ad, #6c3483);
}

/* Thème Speed Verb */
body[data-game="speed-verb"] .game-mini-avatar {
  border-color: #e74c3c;
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.4),
    0 0 20px rgba(231, 76, 60, 0.3);
}

body[data-game="speed-verb"] .mini-avatar-name {
  color: #e74c3c;
}

body[data-game="speed-verb"] .mini-avatar-xp-bar .xp-fill {
  background: linear-gradient(90deg, #e74c3c, #c0392b, #a93226);
}

/* ===========================================
   COMPOSANTS D'AVATAR INTÉGRÉS - JEUX
   =========================================== */

/* Coach de jeu */
.avatar-game-coach {
  background: linear-gradient(135deg, 
    rgba(46, 204, 113, 0.1), 
    rgba(52, 152, 219, 0.1)
  );
  border: 2px solid var(--color-primary, #2ecc71);
  border-radius: 20px;
  padding: 20px;
  margin: 20px auto;
  max-width: 600px;
  text-align: center;
}

.coach-avatar-section {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.coach-speech-bubble {
  position: relative;
  background: linear-gradient(135deg, #2ecc71, #3498db);
  color: white;
  padding: 15px 20px;
  border-radius: 20px;
  font-weight: 600;
  min-width: 200px;
  animation: speechBubbleFloat 3s ease-in-out infinite;
}

.coach-speech-bubble .speech-arrow {
  position: absolute;
  left: -10px;
  top: 50%;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-top: 10px solid transparent;
  border-bottom: 10px solid transparent;
  border-right: 10px solid #2ecc71;
}

@keyframes speechBubbleFloat {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

.coach-tips {
  display: flex;
  gap: 15px;
  justify-content: center;
  flex-wrap: wrap;
}

.tip-item {
  background: rgba(255, 255, 255, 0.1);
  padding: 10px 15px;
  border-radius: 15px;
  font-size: 0.9rem;
  color: var(--color-text-primary, white);
  border: 1px solid rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(10px);
}

/* Panel de progression */
.avatar-progression-panel {
  background: linear-gradient(135deg, 
    rgba(0, 0, 0, 0.9), 
    rgba(30, 30, 30, 0.9)
  );
  border: 2px solid var(--color-secondary, #3498db);
  border-radius: 20px;
  padding: 20px;
  margin-bottom: 20px;
  backdrop-filter: blur(15px);
}

.progression-header {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-bottom: 15px;
}

.progression-info h3 {
  color: var(--color-primary, #2ecc71);
  margin: 0 0 10px 0;
  font-size: 1.2rem;
}

.live-stats {
  display: flex;
  gap: 15px;
  flex-wrap: wrap;
}

.stat-item {
  display: flex;
  align-items: center;
  gap: 5px;
  background: rgba(255, 255, 255, 0.1);
  padding: 8px 12px;
  border-radius: 10px;
  font-size: 0.9rem;
}

.stat-icon {
  font-size: 1.2rem;
}

.stat-value {
  font-weight: bold;
  color: var(--color-primary, #2ecc71);
}

.progression-bar {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  padding: 10px;
  text-align: center;
  position: relative;
  overflow: hidden;
}

.progress-fill {
  background: linear-gradient(90deg, 
    var(--color-primary, #2ecc71), 
    var(--color-secondary, #3498db)
  );
  height: 8px;
  border-radius: 4px;
  transition: width 0.3s ease;
  margin-bottom: 5px;
}

.progress-text {
  font-size: 0.8rem;
  color: rgba(255, 255, 255, 0.8);
}

/* Compagnon de réaction */
.avatar-reaction-companion {
  background: linear-gradient(135deg, 
    rgba(0, 0, 0, 0.95), 
    rgba(30, 30, 30, 0.95)
  );
  border: 2px solid var(--color-accent, #f1c40f);
  border-radius: 20px;
  padding: 15px;
  backdrop-filter: blur(15px);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

.companion-avatar {
  margin-bottom: 15px;
}

.dialogue-box {
  background: linear-gradient(135deg, #f1c40f, #e67e22);
  color: #2c3e50;
  padding: 12px 15px;
  border-radius: 15px;
  margin-bottom: 10px;
  font-weight: 600;
  position: relative;
}

.dialogue-emotions {
  display: flex;
  gap: 8px;
  justify-content: center;
}

.emotion-indicator {
  width: 35px;
  height: 35px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 1.2rem;
}

.emotion-indicator:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: scale(1.1);
}

/* ===========================================
   COMPOSANTS D'AVATAR INTÉGRÉS - COURS
   =========================================== */

/* Professeur virtuel */
.avatar-virtual-teacher {
  background: linear-gradient(135deg, 
    rgba(155, 89, 182, 0.1), 
    rgba(142, 68, 173, 0.1)
  );
  border: 3px solid #9b59b6;
  border-radius: 25px;
  padding: 30px;
  margin: 30px auto;
  max-width: 800px;
  box-shadow: 0 10px 30px rgba(155, 89, 182, 0.2);
}

.teacher-presentation {
  display: flex;
  align-items: center;
  gap: 30px;
  margin-bottom: 25px;
  flex-wrap: wrap;
}

.teacher-introduction h2 {
  color: #9b59b6;
  margin: 0 0 15px 0;
  font-size: 1.8rem;
}

.teacher-introduction p {
  color: var(--color-text-primary, white);
  line-height: 1.6;
  margin-bottom: 15px;
}

.teacher-mood-indicator {
  background: rgba(155, 89, 182, 0.2);
  padding: 10px 15px;
  border-radius: 15px;
  border: 1px solid #9b59b6;
}

.mood-text {
  font-size: 0.9rem;
  color: #9b59b6;
  font-weight: 600;
}

.mood-bar {
  background: rgba(255, 255, 255, 0.1);
  height: 6px;
  border-radius: 3px;
  margin-top: 5px;
  overflow: hidden;
}

.mood-fill.teaching {
  background: linear-gradient(90deg, #9b59b6, #8e44ad);
  height: 100%;
  width: 85%;
  border-radius: 3px;
  animation: moodPulse 2s ease-in-out infinite;
}

@keyframes moodPulse {
  0%, 100% { opacity: 0.8; }
  50% { opacity: 1; }
}

.teacher-controls {
  display: flex;
  gap: 15px;
  justify-content: center;
  flex-wrap: wrap;
}

.teacher-btn {
  background: linear-gradient(135deg, #9b59b6, #8e44ad);
  color: white;
  border: none;
  padding: 12px 20px;
  border-radius: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 0.9rem;
}

.teacher-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(155, 89, 182, 0.4);
}

/* Assistant d'apprentissage */
.avatar-learning-assistant {
  background: linear-gradient(135deg, 
    rgba(52, 152, 219, 0.1), 
    rgba(41, 128, 185, 0.1)
  );
  border: 2px solid #3498db;
  border-radius: 20px;
  padding: 20px;
  backdrop-filter: blur(10px);
  box-shadow: 0 8px 25px rgba(52, 152, 219, 0.2);
}

.assistant-header {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-bottom: 15px;
}

.assistant-info h4 {
  color: #3498db;
  margin: 0 0 5px 0;
  font-size: 1.1rem;
}

.assistant-status {
  color: var(--color-text-secondary, rgba(255, 255, 255, 0.7));
  font-size: 0.9rem;
}

.assistant-tools {
  margin-bottom: 15px;
}

.tool-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  margin-bottom: 8px;
}

.tool-item:hover {
  background: rgba(52, 152, 219, 0.2);
  transform: translateX(5px);
}

.tool-icon {
  font-size: 1.2rem;
  width: 25px;
  text-align: center;
}

.tool-name {
  font-size: 0.9rem;
  color: var(--color-text-primary, white);
}

.assistant-suggestions {
  background: rgba(52, 152, 219, 0.2);
  padding: 12px;
  border-radius: 12px;
  border-left: 4px solid #3498db;
}

.suggestion-text {
  font-size: 0.9rem;
  color: var(--color-text-primary, white);
  line-height: 1.4;
}

/* Coach motivationnel */
.avatar-motivational-coach {
  background: linear-gradient(135deg, 
    rgba(231, 76, 60, 0.1), 
    rgba(192, 57, 43, 0.1)
  );
  border: 2px solid #e74c3c;
  border-radius: 20px;
  padding: 20px;
  backdrop-filter: blur(15px);
  box-shadow: 0 8px 32px rgba(231, 76, 60, 0.2);
}

.coach-container {
  display: flex;
  align-items: center;
  gap: 15px;
}

.coach-avatar-animated {
  position: relative;
  animation: coachBounce 3s ease-in-out infinite;
}

@keyframes coachBounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

.energy-aura {
  position: absolute;
  top: -10px;
  left: -10px;
  right: -10px;
  bottom: -10px;
  background: radial-gradient(circle, 
    rgba(231, 76, 60, 0.3) 0%, 
    transparent 70%
  );
  border-radius: 50%;
  animation: auraGlow 2s ease-in-out infinite;
}

@keyframes auraGlow {
  0%, 100% { opacity: 0.5; transform: scale(1); }
  50% { opacity: 0.8; transform: scale(1.1); }
}

.motivation-content {
  flex: 1;
}

.motivation-message {
  color: #e74c3c;
  font-weight: 700;
  font-size: 1.1rem;
  margin-bottom: 10px;
}

.progress-bar-motivational {
  background: rgba(255, 255, 255, 0.1);
  height: 8px;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 5px;
}

.progress-fill-motivational {
  background: linear-gradient(90deg, #e74c3c, #c0392b);
  height: 100%;
  border-radius: 4px;
  transition: width 0.5s ease;
  animation: progressShine 3s ease-in-out infinite;
}

@keyframes progressShine {
  0%, 100% { box-shadow: 0 0 5px rgba(231, 76, 60, 0.5); }
  50% { box-shadow: 0 0 15px rgba(231, 76, 60, 0.8); }
}

/* ===========================================
   AVATARS DE DIFFÉRENTES TAILLES
   =========================================== */

/* Avatar large (professeur) */
.avatar-display-large {
  width: 150px;
  height: 180px;
  position: relative;
  margin: 0 auto;
}

.avatar-display-large .avatar-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 1;
  border-radius: 20px;
  opacity: 0.4;
}

.avatar-display-large .avatar-body {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 90px;
  height: auto;
  object-fit: contain;
  z-index: 5;
}

.avatar-display-large .avatar-head {
  position: absolute;
  bottom: 54px;
  left: 50%;
  transform: translateX(-50%);
  width: 60px;
  height: auto;
  object-fit: contain;
  z-index: 10;
}

.avatar-display-large .avatar-accessory {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 38px;
  height: 38px;
  z-index: 15;
}

/* Avatar medium (assistants) */
.avatar-display-medium {
  width: 100px;
  height: 120px;
  position: relative;
  margin: 0 auto;
}

.avatar-display-medium .avatar-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 1;
  border-radius: 15px;
  opacity: 0.3;
}

.avatar-display-medium .avatar-body {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 60px;
  height: auto;
  object-fit: contain;
  z-index: 5;
}

.avatar-display-medium .avatar-head {
  position: absolute;
  bottom: 36px;
  left: 50%;
  transform: translateX(-50%);
  width: 40px;
  height: auto;
  object-fit: contain;
  z-index: 10;
}

.avatar-display-medium .avatar-accessory {
  position: absolute;
  top: 5px;
  right: 5px;
  width: 25px;
  height: 25px;
  z-index: 15;
}

/* ===========================================
   RESPONSIVE MOBILE POUR COMPOSANTS INTÉGRÉS
   =========================================== */

/* Mobile pour composants de jeu */
@media (max-width: 768px) {
  .avatar-game-coach {
    margin: 15px;
    padding: 15px;
    max-width: none;
  }
  
  .coach-avatar-section {
    flex-direction: column;
    gap: 15px;
  }
  
  .coach-speech-bubble {
    min-width: auto;
    font-size: 0.9rem;
    padding: 12px 15px;
  }
  
  .coach-tips {
    flex-direction: column;
    gap: 10px;
  }
  
  .tip-item {
    text-align: center;
    font-size: 0.85rem;
  }
  
  /* Panel de progression mobile */
  .avatar-progression-panel {
    margin: 10px;
    padding: 15px;
  }
  
  .progression-header {
    flex-direction: column;
    gap: 10px;
    text-align: center;
  }
  
  .live-stats {
    justify-content: center;
    gap: 10px;
  }
  
  .stat-item {
    font-size: 0.8rem;
    padding: 6px 10px;
  }
  
  /* Compagnon de réaction mobile */
  .avatar-reaction-companion {
    position: fixed !important;
    bottom: 10px !important;
    left: 10px !important;
    right: 10px !important;
    max-width: none !important;
    transform: none !important;
  }
  
  .companion-dialogue {
    text-align: center;
  }
  
  .dialogue-box {
    font-size: 0.9rem;
    padding: 10px 12px;
  }
  
  .emotion-indicator {
    width: 30px;
    height: 30px;
    font-size: 1rem;
  }
}

/* Mobile pour composants de cours */
@media (max-width: 768px) {
  .avatar-virtual-teacher {
    margin: 15px;
    padding: 20px;
    max-width: none;
  }
  
  .teacher-presentation {
    flex-direction: column;
    gap: 20px;
    text-align: center;
  }
  
  .teacher-introduction h2 {
    font-size: 1.5rem;
  }
  
  .teacher-controls {
    gap: 10px;
  }
  
  .teacher-btn {
    padding: 10px 15px;
    font-size: 0.85rem;
    flex: 1;
    min-width: calc(50% - 5px);
  }
  
  /* Assistant d'apprentissage mobile */
  .avatar-learning-assistant {
    position: static !important;
    float: none !important;
    width: 100% !important;
    max-width: none !important;
    margin: 15px 0 !important;
  }
  
  .assistant-header {
    flex-direction: column;
    text-align: center;
    gap: 10px;
  }
  
  .tool-item {
    justify-content: center;
    padding: 12px;
  }
  
  /* Coach motivationnel mobile */
  .avatar-motivational-coach {
    position: fixed !important;
    bottom: 10px !important;
    right: 10px !important;
    left: 10px !important;
    max-width: none !important;
  }
  
  .coach-container {
    flex-direction: column;
    text-align: center;
    gap: 10px;
  }
  
  .motivation-message {
    font-size: 1rem;
  }
}

/* Très petits écrans */
@media (max-width: 480px) {
  .avatar-game-coach {
    padding: 12px;
    margin: 10px;
  }
  
  .coach-speech-bubble {
    font-size: 0.85rem;
    padding: 10px 12px;
  }
  
  .avatar-progression-panel {
    padding: 12px;
  }
  
  .live-stats {
    flex-direction: column;
    gap: 8px;
  }
  
  .stat-item {
    justify-content: center;
  }
  
  .avatar-virtual-teacher {
    padding: 15px;
  }
  
  .teacher-introduction h2 {
    font-size: 1.3rem;
  }
  
  .teacher-controls {
    flex-direction: column;
    gap: 8px;
  }
  
  .teacher-btn {
    width: 100%;
    min-width: auto;
  }
}

/* Mode paysage mobile */
@media (max-width: 768px) and (orientation: landscape) {
  .avatar-game-coach {
    padding: 10px;
    margin: 10px;
  }
  
  .coach-avatar-section {
    flex-direction: row;
    gap: 15px;
  }
  
  .avatar-progression-panel {
    padding: 10px;
  }
  
  .progression-header {
    flex-direction: row;
    text-align: left;
  }
  
  .avatar-virtual-teacher {
    padding: 15px;
    margin: 10px;
  }
  
  .teacher-presentation {
    flex-direction: row;
    text-align: left;
  }
  
  .teacher-controls {
    flex-direction: row;
    flex-wrap: wrap;
  }
}

/* ===========================================
   AVATAR DE COMBAT/APPRENTISSAGE - SIMPLIFIÉ
   =========================================== */

/* Avatar de combat pour jeux */
.avatar-game-battle {
  background: linear-gradient(135deg, 
    rgba(231, 76, 60, 0.1), 
    rgba(192, 57, 43, 0.1)
  );
  border: 2px solid #e74c3c;
  border-radius: 15px;
  padding: 15px;
  margin: 15px auto;
  max-width: 400px;
  display: flex;
  align-items: center;
  gap: 15px;
  backdrop-filter: blur(10px);
  box-shadow: 0 8px 25px rgba(231, 76, 60, 0.2);
}

.battle-status {
  display: flex;
  align-items: center;
  gap: 15px;
  width: 100%;
}

.battle-avatar-container {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
}

.battle-state-indicator {
  flex: 1;
}

.battle-state-indicator .state-text {
  color: #e74c3c;
  font-weight: 700;
  font-size: 1rem;
  margin-bottom: 8px;
}

.effort-bar {
  background: rgba(255, 255, 255, 0.1);
  height: 8px;
  border-radius: 4px;
  overflow: hidden;
}

.effort-fill {
  height: 100%;
  border-radius: 4px;
  transition: all 0.5s ease;
  background: linear-gradient(90deg, #95a5a6, #7f8c8d);
}

.battle-emotions {
  text-align: center;
}

.battle-emotions .emotion-display {
  font-size: 2.5rem;
  animation: emotionBounce 2s ease-in-out infinite;
}

@keyframes emotionBounce {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

/* Avatar d'apprentissage pour cours */
.avatar-learning-buddy {
  background: linear-gradient(135deg, 
    rgba(52, 152, 219, 0.1), 
    rgba(41, 128, 185, 0.1)
  );
  border: 2px solid #3498db;
  border-radius: 15px;
  padding: 15px;
  margin: 20px auto;
  max-width: 400px;
  display: flex;
  align-items: center;
  gap: 15px;
  backdrop-filter: blur(10px);
  box-shadow: 0 8px 25px rgba(52, 152, 219, 0.2);
}

.learning-status {
  display: flex;
  align-items: center;
  gap: 15px;
  width: 100%;
}

.buddy-avatar-container {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
}

.learning-state-indicator {
  flex: 1;
}

.learning-state-indicator .state-text {
  color: #3498db;
  font-weight: 700;
  font-size: 1rem;
  margin-bottom: 8px;
}

.comprehension-bar {
  background: rgba(255, 255, 255, 0.1);
  height: 8px;
  border-radius: 4px;
  overflow: hidden;
}

.comprehension-fill {
  height: 100%;
  border-radius: 4px;
  transition: all 0.5s ease;
  background: linear-gradient(90deg, #e74c3c, #c0392b);
}

.learning-emotions {
  text-align: center;
}

.learning-emotions .emotion-display {
  font-size: 2.5rem;
  animation: emotionBounce 2s ease-in-out infinite;
}

/* Animations d'état émotionnel */
@keyframes emotionPulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.3); }
  100% { transform: scale(1); }
}

@keyframes thinkingTilt {
  0%, 100% { transform: rotate(0deg); }
  25% { transform: rotate(-5deg); }
  75% { transform: rotate(5deg); }
}

@keyframes effortShake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-3px); }
  75% { transform: translateX(3px); }
}

@keyframes victoryNod {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

@keyframes celebrationJump {
  0%, 100% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-12px) scale(1.1); }
}

@keyframes defeatDrop {
  0% { transform: translateY(0); }
  100% { transform: translateY(5px); }
}

/* ===========================================
   RESPONSIVE MOBILE POUR AVATARS SIMPLIFIÉS
   =========================================== */

/* Mobile pour avatar de combat */
@media (max-width: 768px) {
  .avatar-game-battle {
    margin: 10px;
    padding: 12px;
    max-width: none;
    flex-direction: column;
    gap: 12px;
  }
  
  .battle-status {
    flex-direction: column;
    gap: 12px;
    text-align: center;
  }
  
  .battle-avatar-container {
    justify-content: center;
    gap: 10px;
  }
  
  .battle-state-indicator .state-text {
    font-size: 0.9rem;
    margin-bottom: 6px;
  }
  
  .battle-emotions .emotion-display {
    font-size: 2rem;
  }
  
  /* Avatar d'apprentissage mobile */
  .avatar-learning-buddy {
    margin: 10px;
    padding: 12px;
    max-width: none;
    flex-direction: column;
    gap: 12px;
  }
  
  .learning-status {
    flex-direction: column;
    gap: 12px;
    text-align: center;
  }
  
  .buddy-avatar-container {
    justify-content: center;
    gap: 10px;
  }
  
  .learning-state-indicator .state-text {
    font-size: 0.9rem;
    margin-bottom: 6px;
  }
  
  .learning-emotions .emotion-display {
    font-size: 2rem;
  }
}

/* Très petits écrans */
@media (max-width: 480px) {
  .avatar-game-battle,
  .avatar-learning-buddy {
    padding: 10px;
    margin: 8px;
  }
  
  .battle-state-indicator .state-text,
  .learning-state-indicator .state-text {
    font-size: 0.85rem;
  }
  
  .battle-emotions .emotion-display,
  .learning-emotions .emotion-display {
    font-size: 1.8rem;
  }
  
  .effort-bar,
  .comprehension-bar {
    height: 6px;
  }
}

/* ===========================================
   AVATAR CENTRAL MOTIVANT - NOUVEAU SYSTÈME
   =========================================== */

/* Avatar motivationnel central */
.avatar-motivational-center {
  background: linear-gradient(135deg, 
    rgba(46, 204, 113, 0.1), 
    rgba(52, 152, 219, 0.1),
    rgba(155, 89, 182, 0.1)
  );
  border: 3px solid transparent;
  background-clip: padding-box;
  border-radius: 25px;
  padding: 25px;
  margin: 20px auto;
  max-width: 700px;
  position: relative;
  overflow: hidden;
  backdrop-filter: blur(15px);
  box-shadow: 
    0 15px 35px rgba(0, 0, 0, 0.3),
    0 0 30px rgba(46, 204, 113, 0.2);
}

.avatar-motivational-center::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, #2ecc71, #3498db, #9b59b6, #e74c3c);
  background-size: 400% 400%;
  animation: gradientShift 8s ease-in-out infinite;
  z-index: -1;
  border-radius: 25px;
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.center-avatar-showcase {
  display: flex;
  align-items: center;
  gap: 25px;
  margin-bottom: 20px;
}

/* Avatar display large central */
.avatar-display-large-center {
  position: relative;
  min-width: 200px;
  width: 200px;
  height: 240px;
}

.avatar-display-large-center .avatar-display-large {
  width: 100%;
  height: 100%;
  position: relative;
}

/* Positionnement perfectionné pour le large avatar */
.avatar-display-large .large-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 1;
  border-radius: 20px;
  opacity: 0.4;
}

.avatar-display-large .large-body {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 130px;
  height: auto;
  object-fit: contain;
  z-index: 5;
  transition: all 0.3s ease;
}

.avatar-display-large .large-head {
  position: absolute;
  bottom: 75px; /* Collé au corps */
  left: 50%;
  transform: translateX(-50%);
  width: 60px;
  height: auto;
  object-fit: contain;
  z-index: 10;
  transition: all 0.3s ease;
}

.avatar-display-large .large-accessory {
  position: absolute;
  top: 10px;
  right: 10px;
  width: 60px;
  height: 60px;
  z-index: 15;
  transition: all 0.3s ease;
  filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.8));
  animation: accessorySparkle 4s ease-in-out infinite;
}

@keyframes accessorySparkle {
  0%, 100% { 
    filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.8)) brightness(1);
    transform: scale(1);
  }
  50% { 
    filter: drop-shadow(0 0 20px rgba(255, 255, 255, 1)) brightness(1.3);
    transform: scale(1.1);
  }
}

/* Overlay d'effets */
.avatar-effects-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 20px;
  pointer-events: none;
  z-index: 20;
}

.avatar-effects-overlay.readyGlow {
  background: radial-gradient(circle, rgba(46, 204, 113, 0.3) 0%, transparent 70%);
  animation: readyPulse 2s ease-in-out infinite;
}

.avatar-effects-overlay.focusAura {
  background: radial-gradient(circle, rgba(52, 152, 219, 0.4) 0%, transparent 60%);
  animation: focusShimmer 1.5s ease-in-out infinite;
}

.avatar-effects-overlay.battleSparks {
  background: 
    radial-gradient(circle at 20% 30%, rgba(231, 76, 60, 0.6) 0%, transparent 40%),
    radial-gradient(circle at 80% 70%, rgba(243, 156, 18, 0.6) 0%, transparent 40%);
  animation: battleFlash 0.8s ease-in-out infinite;
}

.avatar-effects-overlay.successBurst {
  background: 
    radial-gradient(circle, rgba(46, 204, 113, 0.8) 0%, transparent 50%),
    conic-gradient(from 0deg, #2ecc71, #f1c40f, #e74c3c, #9b59b6, #2ecc71);
  animation: successExplosion 1s ease-out;
}

.avatar-effects-overlay.masterAura {
  background: 
    radial-gradient(circle, rgba(155, 89, 182, 0.6) 0%, transparent 60%),
    linear-gradient(45deg, rgba(241, 196, 15, 0.3), rgba(231, 76, 60, 0.3));
  animation: masterGlow 2s ease-in-out infinite;
}

/* Panel de motivation */
.motivation-panel {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.player-identity h3 {
  color: #2ecc71;
  font-size: 1.8rem;
  font-weight: 700;
  margin: 0 0 8px 0;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}

.level-badge {
  background: linear-gradient(135deg, #f1c40f, #e67e22);
  color: #2c3e50;
  padding: 6px 15px;
  border-radius: 20px;
  font-weight: 700;
  font-size: 0.9rem;
  display: inline-block;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.achievement-text {
  color: #ffffff;
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: 10px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.7);
}

.xp-progress-visual {
  background: rgba(255, 255, 255, 0.1);
  height: 12px;
  border-radius: 6px;
  overflow: hidden;
  border: 1px solid rgba(255, 255, 255, 0.2);
  position: relative;
}

.xp-fill-animated {
  height: 100%;
  background: linear-gradient(90deg, #2ecc71, #3498db, #9b59b6);
  border-radius: 6px;
  transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.xp-fill-animated::after {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
  animation: xpShine 2s ease-in-out infinite;
}

@keyframes xpShine {
  0% { left: -100%; }
  100% { left: 100%; }
}

/* Showcase des skins */
.skin-showcase {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 15px;
  padding: 15px;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.current-skin-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 15px;
  flex-wrap: wrap;
}

.skin-name {
  color: #f1c40f;
  font-weight: 600;
  font-size: 1rem;
}

.upgrade-hint {
  background: linear-gradient(135deg, #9b59b6, #8e44ad);
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 20px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 0.9rem;
}

.upgrade-hint:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 15px rgba(155, 89, 182, 0.4);
}

/* Feedback en direct */
.live-feedback {
  text-align: center;
  background: rgba(0, 0, 0, 0.4);
  border-radius: 15px;
  padding: 12px 20px;
}

.feedback-text {
  color: #ffffff;
  font-size: 1.1rem;
  font-weight: 600;
  animation: feedbackPulse 3s ease-in-out infinite;
}

/* Preview des skins */
.skin-preview-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(10px);
  z-index: 2000;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.skin-preview-modal {
  background: linear-gradient(135deg, rgba(30, 30, 30, 0.95), rgba(60, 60, 60, 0.95));
  border: 2px solid #2ecc71;
  border-radius: 20px;
  padding: 30px;
  max-width: 600px;
  width: 100%;
  max-height: 80vh;
  overflow-y: auto;
}

.preview-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
}

.preview-header h2 {
  color: #2ecc71;
  margin: 0;
  font-size: 1.8rem;
}

.close-preview {
  background: #e74c3c;
  color: white;
  border: none;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  font-size: 1.5rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.skins-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-bottom: 25px;
}

.skin-card {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 20px;
  text-align: center;
  border: 2px solid transparent;
  transition: all 0.3s ease;
}

.skin-card.unlockable {
  border-color: #f1c40f;
}

.skin-card.premium {
  border-color: #9b59b6;
}

.skin-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
}

.skin-avatar-preview {
  position: relative;
  width: 120px;
  height: 144px;
  margin: 0 auto 15px;
}

.skin-avatar-preview .preview-body {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 78px;
  height: auto;
  z-index: 5;
}

.skin-avatar-preview .preview-head {
  position: absolute;
  bottom: 45px; /* Collé au corps */
  left: 50%;
  transform: translateX(-50%);
  width: 54px;
  height: auto;
  z-index: 10;
}

.skin-info h4 {
  color: #ffffff;
  margin: 0 0 10px 0;
  font-size: 1.2rem;
}

.unlock-condition {
  color: #f1c40f;
  margin: 8px 0;
  font-weight: 600;
}

.progress-to-unlock {
  color: #2ecc71;
  font-size: 0.9rem;
  margin: 5px 0;
}

.upgrade-btn {
  background: linear-gradient(135deg, #f1c40f, #e67e22);
  color: #2c3e50;
  border: none;
  padding: 10px 20px;
  border-radius: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  margin-top: 10px;
}

.upgrade-btn::before {
  content: '🪙 ';
  margin-right: 5px;
}

.unlock-condition::before {
  content: '🪙 ';
  margin-right: 5px;
}

.motivation-message {
  text-align: center;
  background: rgba(46, 204, 113, 0.1);
  border-radius: 10px;
  padding: 15px;
  border: 1px solid #2ecc71;
}

.motivation-message p {
  color: #ffffff;
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
}

/* Animations spéciales */
@keyframes readyPulse {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

@keyframes focusShimmer {
  0%, 100% { opacity: 0.8; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.05); }
}

@keyframes battleFlash {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

@keyframes successExplosion {
  0% { opacity: 0; transform: scale(0.5); }
  50% { opacity: 1; transform: scale(1.2); }
  100% { opacity: 0.8; transform: scale(1); }
}

@keyframes masterGlow {
  0%, 100% { opacity: 0.8; transform: rotate(0deg); }
  50% { opacity: 1; transform: rotate(5deg); }
}

@keyframes feedbackPulse {
  0%, 100% { opacity: 0.8; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.02); }
}

@keyframes skinHintPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

@keyframes textGlow {
  0%, 100% { text-shadow: 0 2px 4px rgba(0, 0, 0, 0.7); }
  50% { text-shadow: 0 0 15px rgba(46, 204, 113, 0.8); }
}

@keyframes containerPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

/* Animations du corps et de la tête */
@keyframes readyStance {
  0%, 100% { transform: translateX(-50%) translateY(0); }
  50% { transform: translateX(-50%) translateY(-3px); }
}

@keyframes confidentNod {
  0%, 100% { transform: translateX(-50%) translateY(0); }
  50% { transform: translateX(-50%) translateY(-5px); }
}

@keyframes focusedLean {
  0%, 100% { transform: translateX(-50%) rotate(0deg); }
  50% { transform: translateX(-50%) rotate(-2deg); }
}

@keyframes thinkingTilt {
  0%, 100% { transform: translateX(-50%) rotate(0deg); }
  25% { transform: translateX(-50%) rotate(-3deg); }
  75% { transform: translateX(-50%) rotate(3deg); }
}

@keyframes battleStance {
  0%, 100% { transform: translateX(-50%) scale(1); }
  50% { transform: translateX(-50%) scale(1.05); }
}

@keyframes determinedSquint {
  0%, 100% { transform: translateX(-50%) scale(1); }
  50% { transform: translateX(-50%) scale(0.98); }
}

@keyframes victoryPump {
  0%, 100% { transform: translateX(-50%) translateY(0) scale(1); }
  50% { transform: translateX(-50%) translateY(-8px) scale(1.1); }
}

@keyframes triumphantSmile {
  0%, 100% { transform: translateX(-50%) translateY(0) scale(1); }
  50% { transform: translateX(-50%) translateY(-5px) scale(1.05); }
}

@keyframes championPose {
  0%, 100% { transform: translateX(-50%) translateY(0) rotate(0deg) scale(1); }
  50% { transform: translateX(-50%) translateY(-10px) rotate(2deg) scale(1.1); }
}

@keyframes prideNod {
  0%, 100% { transform: translateX(-50%) translateY(0) scale(1); }
  33% { transform: translateX(-50%) translateY(-3px) scale(1.02); }
  66% { transform: translateX(-50%) translateY(-6px) scale(1.05); }
}

/* ===========================================
   RESPONSIVE MOBILE POUR AVATAR CENTRAL
   =========================================== */

/* Tablettes */
@media (max-width: 1024px) {
  .avatar-motivational-center {
    max-width: 600px;
    padding: 20px;
    margin: 15px auto;
  }
  
  .center-avatar-showcase {
    gap: 20px;
  }
  
  .avatar-display-large-center {
    width: 180px;
    height: 216px;
  }
  
  .avatar-display-large .large-body {
    width: 117px;
  }
  
  .avatar-display-large .large-head {
    width: 81px;
    bottom: 67px;
  }
  
  .avatar-display-large .large-accessory {
    width: 54px;
    height: 54px;
  }
}

/* Mobile */
@media (max-width: 768px) {
  .avatar-motivational-center {
    margin: 10px;
    padding: 15px;
    max-width: none;
  }
  
  .center-avatar-showcase {
    flex-direction: column;
    gap: 15px;
    text-align: center;
  }
  
  .avatar-display-large-center {
    width: 160px;
    height: 192px;
    margin: 0 auto;
  }
  
  .avatar-display-large .large-body {
    width: 104px;
  }
  
  .avatar-display-large .large-head {
    width: 72px;
    bottom: 60px;
  }
  
  .avatar-display-large .large-accessory {
    width: 48px;
    height: 48px;
  }
  
  .player-identity h3 {
    font-size: 1.5rem;
  }
  
  .achievement-text {
    font-size: 1.1rem;
  }
  
  .current-skin-info {
    flex-direction: column;
    gap: 10px;
    text-align: center;
  }
  
  .skin-preview-modal {
    padding: 20px;
    margin: 10px;
  }
  
  .skins-grid {
    grid-template-columns: 1fr;
    gap: 15px;
  }
}

/* Très petits écrans */
@media (max-width: 480px) {
  .avatar-motivational-center {
    padding: 12px;
    margin: 8px;
  }
  
  .avatar-display-large-center {
    width: 140px;
    height: 168px;
  }
  
  .avatar-display-large .large-body {
    width: 91px;
  }
  
  .avatar-display-large .large-head {
    width: 63px;
    bottom: 52px;
  }
  
  .avatar-display-large .large-accessory {
    width: 42px;
    height: 42px;
  }
  
  .player-identity h3 {
    font-size: 1.3rem;
  }
  
  .level-badge {
    font-size: 0.8rem;
    padding: 4px 12px;
  }
  
  .achievement-text {
    font-size: 1rem;
  }
  
  .feedback-text {
    font-size: 1rem;
  }
  
  .upgrade-hint {
    font-size: 0.8rem;
    padding: 6px 12px;
  }
}

/* Mode paysage mobile */
@media (max-width: 768px) and (orientation: landscape) {
  .avatar-motivational-center {
    margin: 5px;
    padding: 10px;
  }
  
  .center-avatar-showcase {
    flex-direction: row;
    gap: 15px;
  }
  
  .avatar-display-large-center {
    width: 120px;
    height: 144px;
  }
  
  .avatar-display-large .large-body {
    width: 78px;
  }
  
  .avatar-display-large .large-head {
    width: 54px;
    bottom: 45px;
  }
  
  .avatar-display-large .large-accessory {
    width: 36px;
    height: 36px;
  }
  
  .player-identity h3 {
    font-size: 1.2rem;
  }
  
  .achievement-text {
    font-size: 0.9rem;
  }
}

/* Avatar d'apprentissage mobile */
.avatar-learning-motivator {
  background: linear-gradient(135deg, 
    rgba(52, 152, 219, 0.1), 
    rgba(41, 128, 185, 0.1),
    rgba(155, 89, 182, 0.1)
  );
  border: 3px solid #3498db;
  border-radius: 20px;
  padding: 20px;
  margin: 15px auto;
  max-width: 600px;
  backdrop-filter: blur(15px);
  box-shadow: 
    0 15px 35px rgba(0, 0, 0, 0.3),
    0 0 30px rgba(52, 152, 219, 0.2);
}

.learning-showcase {
  display: flex;
  align-items: center;
  gap: 20px;
}

.learning-progress-panel {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.student-identity h3 {
  color: #3498db;
  font-size: 1.6rem;
  font-weight: 700;
  margin: 0 0 8px 0;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}

.wisdom-level {
  background: linear-gradient(135deg, #3498db, #2980b9);
  color: white;
  padding: 6px 15px;
  border-radius: 20px;
  font-weight: 700;
  font-size: 0.9rem;
  display: inline-block;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.comprehension-text {
  color: #ffffff;
  font-size: 1.2rem;
  font-weight: 600;
  margin-bottom: 10px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.7);
}

.knowledge-bar {
  background: rgba(255, 255, 255, 0.1);
  height: 12px;
  border-radius: 6px;
  overflow: hidden;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.knowledge-fill {
  height: 100%;
  background: linear-gradient(90deg, #3498db, #2980b9, #8e44ad);
  border-radius: 6px;
  transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
}

.learning-aura {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 20px;
  background: radial-gradient(circle, rgba(52, 152, 219, 0.3) 0%, transparent 70%);
  animation: learningGlow 3s ease-in-out infinite;
  pointer-events: none;
  z-index: 20;
}

@keyframes learningGlow {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

/* Mobile pour avatar d'apprentissage */
@media (max-width: 768px) {
  .avatar-learning-motivator {
    margin: 10px;
    padding: 15px;
    max-width: none;
  }
  
  .learning-showcase {
    flex-direction: column;
    gap: 15px;
    text-align: center;
  }
  
  .student-identity h3 {
    font-size: 1.4rem;
  }
  
  .comprehension-text {
    font-size: 1rem;
  }
}

@media (max-width: 480px) {
  .avatar-learning-motivator {
    padding: 12px;
    margin: 8px;
  }
  
  .student-identity h3 {
    font-size: 1.2rem;
  }
  
  .wisdom-level {
    font-size: 0.8rem;
    padding: 4px 12px;
  }
  
  .comprehension-text {
    font-size: 0.9rem;
  }
}

/* ===========================================
   SYSTÈME D'AVATAR MINI EXPLORATEUR - 4 SOLUTIONS
   =========================================== */

/* Modal de choix */
.avatar-choice-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.9);
  backdrop-filter: blur(15px);
  z-index: 3000;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.choice-modal-content {
  background: linear-gradient(135deg, rgba(30, 30, 30, 0.95), rgba(60, 60, 60, 0.95));
  border: 3px solid #2ecc71;
  border-radius: 25px;
  padding: 30px;
  max-width: 800px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  text-align: center;
}

.choice-modal-content h2 {
  color: #2ecc71;
  margin: 0 0 15px 0;
  font-size: 2rem;
}

.choice-modal-content p {
  color: rgba(255, 255, 255, 0.8);
  margin-bottom: 30px;
  font-size: 1.1rem;
}

.avatar-options {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.avatar-option {
  background: rgba(255, 255, 255, 0.1);
  border: 2px solid transparent;
  border-radius: 20px;
  padding: 25px;
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: center;
}

.avatar-option:hover {
  border-color: #2ecc71;
  transform: translateY(-5px);
  box-shadow: 0 10px 30px rgba(46, 204, 113, 0.3);
}

.option-preview {
  font-size: 3rem;
  margin-bottom: 15px;
  animation: optionFloat 3s ease-in-out infinite;
}

.avatar-option h3 {
  color: #2ecc71;
  margin: 0 0 10px 0;
  font-size: 1.3rem;
}

.avatar-option p {
  color: rgba(255, 255, 255, 0.7);
  margin: 0;
  font-size: 0.9rem;
  line-height: 1.4;
}

@keyframes optionFloat {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

.close-choice {
  background: #e74c3c;
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.close-choice:hover {
  background: #c0392b;
  transform: translateY(-2px);
}

/* ===========================================
   AVATAR DISPLAY TINY - BASE COMMUNE
   =========================================== */

.avatar-display-tiny {
  width: 100%;
  height: 100%;
  position: relative;
}

.avatar-body-tiny {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 70%;
  height: auto;
  object-fit: contain;
  z-index: 5;
}

.avatar-head-tiny {
  position: absolute;
  bottom: 50%; /* COLLÉ au corps */
  left: 50%;
  transform: translateX(-50%);
  width: 50%;
  height: auto;
  object-fit: contain;
  z-index: 10;
  margin-bottom: -1px; /* Force le collage */
}

.avatar-accessory-tiny {
  position: absolute;
  top: 8%;
  right: 8%;
  width: 25%;
  height: 25%;
  z-index: 15;
  filter: drop-shadow(0 0 3px rgba(255, 255, 255, 0.8));
}

/* ===========================================
   SOLUTION 1: PET EXPLORATEUR
   =========================================== */

.wandering-pet-avatar {
  position: fixed;
  width: min(12vw, 80px);
  height: min(15vw, 96px);
  z-index: 1200;
  transition: all 2s ease-in-out;
  pointer-events: none;
}

.pet-avatar-tiny {
  width: 100%;
  height: 80%;
  position: relative;
  filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.4));
}

.pet-activity-indicator {
  position: absolute;
  bottom: -5px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0, 0, 0, 0.8);
  color: #2ecc71;
  padding: 3px 8px;
  border-radius: 10px;
  font-size: 0.7rem;
  font-weight: 600;
  white-space: nowrap;
  border: 1px solid #2ecc71;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

@keyframes petHappy {
  0%, 100% { transform: scale(1) rotate(0deg); }
  50% { transform: scale(1.2) rotate(5deg); }
}

@keyframes petCelebrate {
  0%, 100% { transform: translateY(0) scale(1); }
  25% { transform: translateY(-10px) scale(1.1); }
  75% { transform: translateY(-5px) scale(1.05); }
}

@keyframes petComfort {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-3px); }
  75% { transform: translateX(3px); }
}

/* ===========================================
   SOLUTION 2: BUDDY FLOTTANT
   =========================================== */

.floating-buddy-avatar {
  position: fixed;
  top: 15%;
  right: 5%;
  width: min(10vw, 70px);
  height: min(12vw, 84px);
  z-index: 1200;
  pointer-events: none;
}

.buddy-avatar-tiny {
  width: 100%;
  height: 70%;
  position: relative;
  filter: drop-shadow(0 3px 10px rgba(52, 152, 219, 0.4));
}

.buddy-mood-bubble {
  position: absolute;
  top: -15px;
  right: -10px;
  background: rgba(52, 152, 219, 0.9);
  border-radius: 50%;
  width: 25px;
  height: 25px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.9rem;
  border: 2px solid rgba(255, 255, 255, 0.3);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.buddy-progress-ring {
  position: absolute;
  bottom: -10px;
  left: 50%;
  transform: translateX(-50%);
  width: 30px;
  height: 8px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
  overflow: hidden;
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.buddy-progress-ring .progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #2ecc71, #3498db);
  border-radius: 4px;
  width: 0%;
  transition: width 0.5s ease;
}

@keyframes gentleFloat {
  0%, 100% { transform: translateY(0) rotate(0deg); }
  50% { transform: translateY(-8px) rotate(2deg); }
}

/* ===========================================
   SOLUTION 3: ASSISTANT COIN
   =========================================== */

.corner-assistant-avatar {
  position: fixed;
  bottom: 10%;
  left: 5%;
  width: min(10vw, 70px);
  height: min(12vw, 84px);
  z-index: 1200;
  pointer-events: none;
}

.assistant-avatar-tiny {
  width: 100%;
  height: 100%;
  position: relative;
  filter: drop-shadow(0 3px 10px rgba(155, 89, 182, 0.4));
  animation: assistantIdle 5s ease-in-out infinite;
}

.speech-bubble {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(155, 89, 182, 0.95);
  color: white;
  padding: 8px 12px;
  border-radius: 15px;
  font-size: 0.8rem;
  font-weight: 600;
  white-space: nowrap;
  margin-bottom: 5px;
  border: 1px solid rgba(255, 255, 255, 0.3);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  animation: speechAppear 0.3s ease-out;
}

.speech-bubble::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-top: 6px solid rgba(155, 89, 182, 0.95);
}

@keyframes assistantIdle {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

@keyframes speechAppear {
  0% { opacity: 0; transform: translateX(-50%) translateY(10px) scale(0.8); }
  100% { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); }
}

/* ===========================================
   SOLUTION 4: MINI AVENTURIER
   =========================================== */

.mini-adventurer-avatar {
  position: fixed;
  width: min(8vw, 60px);
  height: min(10vw, 72px);
  z-index: 1200;
  pointer-events: none;
  /* Position initiale */
  top: 20%;
  left: 10%;
}

.adventurer-avatar-tiny {
  width: 100%;
  height: 80%;
  position: relative;
  filter: drop-shadow(0 3px 10px rgba(231, 76, 60, 0.4));
}

.adventure-effects {
  position: absolute;
  top: -15px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 1.2rem;
  animation: effectFloat 2s ease-in-out infinite;
}

@keyframes effectFloat {
  0%, 100% { transform: translateX(-50%) translateY(0); }
  50% { transform: translateX(-50%) translateY(-5px); }
}

@keyframes adventurerJump {
  0%, 100% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-15px) scale(1.15); }
}

@keyframes adventurerVictory {
  0%, 100% { transform: rotate(0deg) scale(1); }
  25% { transform: rotate(-10deg) scale(1.1); }
  75% { transform: rotate(10deg) scale(1.1); }
}

@keyframes adventurerThink {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(0.95); }
}

/* ===========================================
   RESPONSIVE MOBILE POUR AVATARS MINI
   =========================================== */

@media (max-width: 768px) {
  .choice-modal-content {
    padding: 20px;
    margin: 10px;
  }
  
  .avatar-options {
    grid-template-columns: 1fr;
    gap: 15px;
  }
  
  .avatar-option {
    padding: 20px;
  }
  
  .option-preview {
    font-size: 2.5rem;
  }
  
  /* Avatars mini plus visibles sur mobile */
  .wandering-pet-avatar {
    width: min(15vw, 90px);
    height: min(18vw, 108px);
  }
  
  .floating-buddy-avatar {
    width: min(12vw, 80px);
    height: min(15vw, 96px);
    top: 12%;
  }
  
  .corner-assistant-avatar {
    width: min(12vw, 80px);
    height: min(15vw, 96px);
    bottom: 8%;
  }
  
  .mini-adventurer-avatar {
    width: min(10vw, 70px);
    height: min(13vw, 84px);
  }
  
  .pet-activity-indicator,
  .speech-bubble {
    font-size: 0.6rem;
    padding: 2px 6px;
  }
}

@media (max-width: 480px) {
  .choice-modal-content h2 {
    font-size: 1.5rem;
  }
  
  .avatar-option {
    padding: 15px;
  }
  
  .option-preview {
    font-size: 2rem;
    margin-bottom: 10px;
  }
  
  /* Encore plus visibles sur très petits écrans */
  .wandering-pet-avatar {
    width: min(18vw, 100px);
    height: min(22vw, 120px);
  }
  
  .floating-buddy-avatar {
    width: min(15vw, 90px);
    height: min(18vw, 108px);
  }
  
  .corner-assistant-avatar {
    width: min(15vw, 90px);
    height: min(18vw, 108px);
  }
  
  .mini-adventurer-avatar {
    width: min(12vw, 80px);
    height: min(15vw, 96px);
  }
}

/* Mode paysage mobile */
@media (max-width: 768px) and (orientation: landscape) {
  .wandering-pet-avatar {
    width: min(12vh, 80px);
    height: min(15vh, 96px);
  }
  
  .floating-buddy-avatar {
    width: min(10vh, 70px);
    height: min(12vh, 84px);
    top: 8%;
    right: 3%;
  }
  
  .corner-assistant-avatar {
    width: min(10vh, 70px);
    height: min(12vh, 84px);
    bottom: 5%;
    left: 3%;
  }
  
  .mini-adventurer-avatar {
    width: min(8vh, 60px);
    height: min(10vh, 72px);
  }
}

/* ===========================================
   MINI AVENTURIER ULTRA-RÉACTIF
   =========================================== */

/* Supprimer tous les anciens styles d'avatar pour éviter les conflits */
.game-mini-avatar,
.avatar-motivational-center,
.avatar-learning-motivator,
.avatar-game-battle,
.avatar-learning-buddy,
.wandering-pet-avatar,
.floating-buddy-avatar,
.corner-assistant-avatar,
.mini-adventurer-avatar,
.avatar-choice-modal {
  display: none !important;
}

/* Container principal de l'aventurier ultra-réactif */
.ultra-reactive-adventurer {
  position: fixed;
  width: min(10vw, 70px);
  height: min(12vw, 84px);
  z-index: 1200;
  pointer-events: none;
  /* Position initiale */
  top: 20%;
  left: 10%;
  transition: all 3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

/* Avatar container */
.adventurer-avatar-ultra {
  width: 100%;
  height: 100%;
  position: relative;
  filter: drop-shadow(0 4px 12px rgba(231, 76, 60, 0.6));
  transform-origin: center bottom;
}

/* Avatar display ultra avec correction tête/corps */
.avatar-display-ultra {
  width: 100%;
  height: 100%;
  position: relative;
}

/* Corps en bas - BASE SOLIDE */
.avatar-body-ultra {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 75%;
  height: auto;
  object-fit: contain;
  z-index: 5;
  display: block !important;
}

/* Tête COLLÉE au corps - CORRECTION ULTRA PRÉCISE */
.avatar-head-ultra {
  position: absolute;
  bottom: 73%; /* POSITION ULTRA-HAUTE pour collage parfait */
  left: 50%;
  transform: translateX(-50%);
  width: 55%;
  height: auto;
  object-fit: contain;
  z-index: 10;
  display: block !important;
  margin-bottom: -6px; /* Collage maximal */
}

/* Accessoire VISIBLE et bien positionné */
.avatar-accessory-ultra {
  position: absolute;
  top: 8%; /* Ajusté pour être sur la tête */
  right: 8%;
  width: 28%;
  height: 28%;
  z-index: 15;
  display: block !important;
  opacity: 1 !important;
  /* Même styles que sur le profil */
  overflow: visible;
  pointer-events: none;
}

.avatar-accessory-ultra img {
  width: 100% !important;
  height: 100% !important;
  display: block !important;
  opacity: 1 !important;
  object-fit: contain;
  /* Forcer le GIF à s'afficher */
  image-rendering: auto;
  animation: none !important;
  background: none !important;
}

/* Effets ultra-réactifs */
.adventure-effects-ultra {
  position: absolute;
  top: -20px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 1.4rem;
  z-index: 20;
  text-shadow: 0 0 6px rgba(0, 0, 0, 0.8);
  animation: effectsFloat 2s ease-in-out infinite;
  min-height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Bulle de dialogue ultra */
.adventure-speech-bubble {
  position: absolute;
  bottom: 110%;
  left: 50%;
  transform: translateX(-50%);
  background: linear-gradient(135deg, rgba(231, 76, 60, 0.95), rgba(192, 57, 43, 0.95));
  color: white;
  padding: 8px 14px;
  border-radius: 18px;
  font-size: 0.8rem;
  font-weight: 700;
  white-space: nowrap;
  margin-bottom: 8px;
  border: 2px solid rgba(255, 255, 255, 0.4);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
  z-index: 25;
  max-width: 120px;
  text-align: center;
}

.adventure-speech-bubble::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 8px solid transparent;
  border-right: 8px solid transparent;
  border-top: 8px solid rgba(231, 76, 60, 0.95);
}

/* Aura réactive */
.adventure-aura {
  position: absolute;
  top: -5px;
  left: -5px;
  right: -5px;
  bottom: -5px;
  border-radius: 50%;
  z-index: 1;
  transition: all 0.5s ease;
}

/* Types d'auras selon l'état */
.adventure-aura.explosion-aura {
  background: radial-gradient(circle, rgba(255, 215, 0, 0.4), rgba(255, 69, 0, 0.2));
  animation: explosionPulse 1s ease-in-out infinite;
}

.adventure-aura.success-aura {
  background: radial-gradient(circle, rgba(46, 204, 113, 0.3), rgba(22, 160, 133, 0.1));
  animation: successGlow 1.5s ease-in-out infinite;
}

.adventure-aura.fire-aura {
  background: radial-gradient(circle, rgba(231, 76, 60, 0.5), rgba(192, 57, 43, 0.2));
  animation: fireIntense 0.5s ease-in-out infinite;
}

.adventure-aura.panic-aura {
  background: radial-gradient(circle, rgba(231, 76, 60, 0.6), rgba(255, 0, 0, 0.3));
  animation: panicFlash 0.3s ease-in-out infinite;
}

.adventure-aura.victory-aura {
  background: radial-gradient(circle, rgba(255, 215, 0, 0.6), rgba(255, 193, 7, 0.3));
  animation: victoryRainbow 2s ease-in-out infinite;
}

/* ANIMATIONS ULTRA-EXPRESSIVES */

/* Animation idle de base */
@keyframes adventurerIdle {
  0%, 100% { transform: scale(1) rotate(0deg); }
  25% { transform: scale(1.02) rotate(0.5deg); }
  50% { transform: scale(1) rotate(0deg); }
  75% { transform: scale(1.02) rotate(-0.5deg); }
}

/* Réactions aux scores */
@keyframes adventurerSmallWin {
  0%, 100% { transform: scale(1) translateY(0); }
  50% { transform: scale(1.1) translateY(-8px); }
}

@keyframes adventurerMediumWin {
  0%, 100% { transform: scale(1) translateY(0) rotate(0deg); }
  25% { transform: scale(1.15) translateY(-12px) rotate(5deg); }
  75% { transform: scale(1.1) translateY(-6px) rotate(-3deg); }
}

@keyframes adventurerBigWin {
  0%, 100% { transform: scale(1) translateY(0) rotate(0deg); }
  20% { transform: scale(1.3) translateY(-20px) rotate(10deg); }
  40% { transform: scale(1.2) translateY(-15px) rotate(-8deg); }
  60% { transform: scale(1.25) translateY(-18px) rotate(6deg); }
  80% { transform: scale(1.15) translateY(-10px) rotate(-4deg); }
}

/* Combo en feu */
@keyframes adventurerOnFire {
  0%, 100% { transform: scale(1.05) rotate(0deg); }
  25% { transform: scale(1.1) rotate(2deg); }
  50% { transform: scale(1.05) rotate(0deg); }
  75% { transform: scale(1.1) rotate(-2deg); }
}

/* Temps critique */
@keyframes adventurerPanic {
  0%, 100% { transform: scale(1) translateX(0); }
  25% { transform: scale(1.05) translateX(-3px); }
  75% { transform: scale(1.05) translateX(3px); }
}

/* Victoire */
@keyframes adventurerVictoryDance {
  0%, 100% { transform: scale(1) rotate(0deg) translateY(0); }
  20% { transform: scale(1.2) rotate(15deg) translateY(-15px); }
  40% { transform: scale(1.15) rotate(-10deg) translateY(-10px); }
  60% { transform: scale(1.25) rotate(20deg) translateY(-20px); }
  80% { transform: scale(1.1) rotate(-5deg) translateY(-8px); }
}

/* Défaite */
@keyframes adventurerDefeated {
  0%, 100% { transform: scale(1) translateY(0); }
  50% { transform: scale(0.9) translateY(5px); }
}

/* Pensée */
@keyframes adventurerThinking {
  0%, 100% { transform: scale(1) rotate(0deg); }
  50% { transform: scale(1.02) rotate(2deg); }
}

/* Frappe au clavier */
@keyframes adventurerType {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.03); }
}

/* Power-ups */
@keyframes adventurerEureka {
  0%, 100% { transform: scale(1) translateY(0); }
  50% { transform: scale(1.15) translateY(-10px); }
}

@keyframes adventurerTimeBoost {
  0%, 100% { transform: scale(1) rotate(0deg); }
  50% { transform: scale(1.1) rotate(360deg); }
}

@keyframes adventurerSkip {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(10px); }
  75% { transform: translateX(-5px); }
}

/* Marche */
@keyframes adventurerWalking {
  0%, 100% { transform: scale(1) rotate(0deg); }
  25% { transform: scale(1.02) rotate(1deg); }
  50% { transform: scale(1) rotate(0deg); }
  75% { transform: scale(1.02) rotate(-1deg); }
}

/* Prêt pour l'action */
@keyframes adventurerReady {
  0%, 100% { transform: scale(1) translateY(0); }
  50% { transform: scale(1.08) translateY(-5px); }
}

/* Animations des auras */
@keyframes explosionPulse {
  0%, 100% { opacity: 0.6; transform: scale(1); }
  50% { opacity: 0.9; transform: scale(1.2); }
}

@keyframes successGlow {
  0%, 100% { opacity: 0.3; transform: scale(1); }
  50% { opacity: 0.6; transform: scale(1.1); }
}

@keyframes fireIntense {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 0.8; }
}

@keyframes panicFlash {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.7; }
}

@keyframes victoryRainbow {
  0% { background: radial-gradient(circle, rgba(255, 215, 0, 0.6), rgba(255, 193, 7, 0.3)); }
  25% { background: radial-gradient(circle, rgba(46, 204, 113, 0.6), rgba(22, 160, 133, 0.3)); }
  50% { background: radial-gradient(circle, rgba(52, 152, 219, 0.6), rgba(41, 128, 185, 0.3)); }
  75% { background: radial-gradient(circle, rgba(155, 89, 182, 0.6), rgba(142, 68, 173, 0.3)); }
  100% { background: radial-gradient(circle, rgba(255, 215, 0, 0.6), rgba(255, 193, 7, 0.3)); }
}

/* Animation des effets flottants */
@keyframes effectsFloat {
  0%, 100% { transform: translateX(-50%) translateY(0); }
  50% { transform: translateX(-50%) translateY(-5px); }
}

/* Animation d'apparition de bulle */
@keyframes speechBubbleAppear {
  0% { opacity: 0; transform: translateX(-50%) translateY(10px) scale(0.8); }
  100% { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); }
}

/* ===========================================
   RESPONSIVE MOBILE POUR AVENTURIER ULTRA
   =========================================== */

@media (max-width: 768px) {
  .ultra-reactive-adventurer {
    width: min(12vw, 85px);
    height: min(15vw, 102px);
  }
  
  .adventure-speech-bubble {
    font-size: 0.7rem;
    padding: 6px 10px;
    max-width: 100px;
  }
  
  .adventure-effects-ultra {
    font-size: 1.2rem;
  }
}

@media (max-width: 480px) {
  .ultra-reactive-adventurer {
    width: min(15vw, 95px);
    height: min(18vw, 114px);
  }
  
  .adventure-speech-bubble {
    font-size: 0.65rem;
    padding: 5px 8px;
    max-width: 90px;
  }
  
  .adventure-effects-ultra {
    font-size: 1.1rem;
  }
}

/* Mode paysage mobile */
@media (max-width: 768px) and (orientation: landscape) {
  .ultra-reactive-adventurer {
    width: min(10vh, 70px);
    height: min(12vh, 84px);
  }
  
  .adventure-speech-bubble {
    font-size: 0.6rem;
    padding: 4px 6px;
    max-width: 80px;
  }
}

/* NOUVELLES ANIMATIONS ULTRA-EXPRESSIVES POUR MOUVEMENTS PURS */

/* Célébrations de score */
@keyframes adventurerBigCelebration {
  0%, 100% { transform: scale(1) translateY(0) rotate(0deg); }
  20% { transform: scale(1.4) translateY(-25px) rotate(15deg); }
  40% { transform: scale(1.2) translateY(-20px) rotate(-10deg); }
  60% { transform: scale(1.3) translateY(-22px) rotate(12deg); }
  80% { transform: scale(1.1) translateY(-15px) rotate(-5deg); }
}

@keyframes adventurerSatisfactionJump {
  0%, 100% { transform: scale(1) translateY(0); }
  50% { transform: scale(1.2) translateY(-15px); }
}

@keyframes adventurerSmallHop {
  0%, 100% { transform: scale(1) translateY(0); }
  50% { transform: scale(1.1) translateY(-8px); }
}

/* Combos et séries */
@keyframes adventurerSpinFire {
  0%, 100% { transform: scale(1.1) rotate(0deg); }
  25% { transform: scale(1.15) rotate(90deg); }
  50% { transform: scale(1.1) rotate(180deg); }
  75% { transform: scale(1.15) rotate(270deg); }
}

@keyframes adventurerStreakSway {
  0%, 100% { transform: scale(1) rotate(0deg); }
  25% { transform: scale(1.05) rotate(5deg); }
  50% { transform: scale(1) rotate(0deg); }
  75% { transform: scale(1.05) rotate(-5deg); }
}

/* Déception et défaite */
@keyframes adventurerDeflate {
  0% { transform: scale(1) translateY(0); }
  50% { transform: scale(0.8) translateY(8px); }
  100% { transform: scale(0.9) translateY(5px); }
}

@keyframes adventurerCollapse {
  0% { transform: scale(1) translateY(0); }
  30% { transform: scale(0.9) translateY(3px); }
  60% { transform: scale(0.7) translateY(10px); }
  100% { transform: scale(0.8) translateY(8px); }
}

/* Panique et stress */
@keyframes adventurerFrantic {
  0%, 100% { transform: translateX(0) scale(1); }
  25% { transform: translateX(-4px) scale(1.05); }
  75% { transform: translateX(4px) scale(1.05); }
}

@keyframes adventurerNervous {
  0%, 100% { transform: scale(1) rotate(0deg); }
  25% { transform: scale(1.02) rotate(1deg); }
  75% { transform: scale(1.02) rotate(-1deg); }
}

/* Victoire explosive */
@keyframes adventurerVictoryExplosion {
  0%, 100% { transform: scale(1) translateY(0) rotate(0deg); }
  10% { transform: scale(1.5) translateY(-30px) rotate(20deg); }
  20% { transform: scale(1.3) translateY(-25px) rotate(-15deg); }
  30% { transform: scale(1.4) translateY(-28px) rotate(25deg); }
  40% { transform: scale(1.2) translateY(-20px) rotate(-10deg); }
  50% { transform: scale(1.35) translateY(-26px) rotate(18deg); }
  60% { transform: scale(1.15) translateY(-18px) rotate(-8deg); }
  70% { transform: scale(1.25) translateY(-22px) rotate(12deg); }
  80% { transform: scale(1.1) translateY(-15px) rotate(-5deg); }
  90% { transform: scale(1.2) translateY(-18px) rotate(8deg); }
}

/* Concentration et focus */
@keyframes adventurerFocus {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

@keyframes adventurerDeepThought {
  0%, 100% { transform: scale(1) rotate(0deg); }
  33% { transform: scale(1.03) rotate(2deg); }
  66% { transform: scale(1.03) rotate(-2deg); }
}

/* Power-ups spécifiques */
@keyframes adventurerLightbulb {
  0%, 100% { transform: scale(1) translateY(0); }
  30% { transform: scale(1.15) translateY(-12px); }
  60% { transform: scale(1.1) translateY(-8px); }
}

@keyframes adventurerTimeWarp {
  0%, 100% { transform: scale(1) rotate(0deg); }
  25% { transform: scale(1.1) rotate(90deg); }
  50% { transform: scale(1.2) rotate(180deg); }
  75% { transform: scale(1.1) rotate(270deg); }
}

@keyframes adventurerRush {
  0%, 100% { transform: translateX(0); }
  20% { transform: translateX(15px); }
  40% { transform: translateX(-10px); }
  60% { transform: translateX(12px); }
  80% { transform: translateX(-8px); }
}

/* Préparation de bataille */
@keyframes adventurerBattleReady {
  0%, 100% { transform: scale(1) translateY(0); }
  25% { transform: scale(1.1) translateY(-8px); }
  50% { transform: scale(1.05) translateY(-5px); }
  75% { transform: scale(1.08) translateY(-6px); }
}

/* Nouvelles auras pour accompagner les mouvements */
.adventure-aura.small-success-aura {
  background: radial-gradient(circle, rgba(46, 204, 113, 0.4), rgba(22, 160, 133, 0.2));
  animation: gentleGlow 1s ease-in-out;
}

.adventure-aura.streak-aura {
  background: radial-gradient(circle, rgba(155, 89, 182, 0.5), rgba(142, 68, 173, 0.3));
  animation: streakPulse 1.5s ease-in-out;
}

.adventure-aura.broken-aura {
  background: radial-gradient(circle, rgba(231, 76, 60, 0.4), rgba(192, 57, 43, 0.2));
  animation: brokenFlash 2s ease-in-out;
}

.adventure-aura.warning-aura {
  background: radial-gradient(circle, rgba(243, 156, 18, 0.4), rgba(211, 84, 0, 0.2));
  animation: warningPulse 1s ease-in-out;
}

.adventure-aura.thinking-aura {
  background: radial-gradient(circle, rgba(52, 152, 219, 0.3), rgba(41, 128, 185, 0.2));
  animation: thinkingShimmer 1.5s ease-in-out;
}

.adventure-aura.powerup-aura {
  background: radial-gradient(circle, rgba(241, 196, 15, 0.6), rgba(230, 126, 34, 0.3));
  animation: powerupBurst 1.5s ease-in-out;
}

.adventure-aura.start-aura {
  background: radial-gradient(circle, rgba(46, 204, 113, 0.5), rgba(52, 152, 219, 0.3));
  animation: startEnergy 2s ease-in-out;
}

.adventure-aura.defeat-aura {
  background: radial-gradient(circle, rgba(149, 165, 166, 0.4), rgba(127, 140, 141, 0.2));
  animation: defeatFade 2s ease-in-out;
}

/* Animations des nouvelles auras */
@keyframes gentleGlow {
  0%, 100% { opacity: 0.4; transform: scale(1); }
  50% { opacity: 0.7; transform: scale(1.1); }
}

@keyframes streakPulse {
  0%, 100% { opacity: 0.5; transform: scale(1); }
  50% { opacity: 0.8; transform: scale(1.2); }
}

@keyframes brokenFlash {
  0%, 100% { opacity: 0.4; }
  20% { opacity: 0.7; }
  40% { opacity: 0.3; }
  60% { opacity: 0.6; }
  80% { opacity: 0.2; }
}

@keyframes warningPulse {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 0.7; }
}

@keyframes thinkingShimmer {
  0%, 100% { opacity: 0.3; transform: scale(1); }
  50% { opacity: 0.6; transform: scale(1.05); }
}

@keyframes powerupBurst {
  0% { opacity: 0.6; transform: scale(1); }
  30% { opacity: 0.9; transform: scale(1.3); }
  100% { opacity: 0.4; transform: scale(1.1); }
}

@keyframes startEnergy {
  0%, 100% { opacity: 0.5; transform: scale(1); }
  50% { opacity: 0.8; transform: scale(1.2); }
}

@keyframes defeatFade {
  0% { opacity: 0.4; transform: scale(1); }
  50% { opacity: 0.6; transform: scale(0.9); }
  100% { opacity: 0.2; transform: scale(0.8); }
}

/* ===========================================
   EFFETS VISUELS VARIÉS (POSITIFS/NÉGATIFS)
   =========================================== */

/* Effets positifs */
.adventure-effects-ultra.positive-sparkles::before {
  content: '✨';
  position: absolute;
  top: -10px;
  left: -10px;
  animation: sparkleEffect 1s ease-in-out;
  font-size: 1.2rem;
}

.adventure-effects-ultra.positive-stars::before {
  content: '⭐';
  position: absolute;
  top: -15px;
  right: -10px;
  animation: starBurst 1.5s ease-in-out;
  font-size: 1.4rem;
}

.adventure-effects-ultra.positive-celebration::before {
  content: '🎉';
  position: absolute;
  top: -20px;
  left: 50%;
  transform: translateX(-50%);
  animation: celebrationPop 2s ease-in-out;
  font-size: 1.6rem;
}

.adventure-effects-ultra.positive-lightning::before {
  content: '⚡';
  position: absolute;
  top: -12px;
  right: -8px;
  animation: lightningStrike 0.8s ease-in-out;
  font-size: 1.3rem;
}

/* Effets négatifs */
.adventure-effects-ultra.negative-sweat::before {
  content: '💦';
  position: absolute;
  top: -8px;
  right: -5px;
  animation: sweatDrop 1s ease-in-out;
  font-size: 1rem;
}

.adventure-effects-ultra.negative-confusion::before {
  content: '❓';
  position: absolute;
  top: -15px;
  left: -8px;
  animation: confusionSpin 1.2s ease-in-out;
  font-size: 1.2rem;
}

.adventure-effects-ultra.negative-stress::before {
  content: '😰';
  position: absolute;
  top: -10px;
  left: 50%;
  transform: translateX(-50%);
  animation: stressShake 1s ease-in-out;
  font-size: 1.1rem;
}

.adventure-effects-ultra.negative-tired::before {
  content: '😴';
  position: absolute;
  top: -12px;
  right: -6px;
  animation: tiredSway 1.5s ease-in-out;
  font-size: 1.1rem;
}

/* Effets neutres/concentration */
.adventure-effects-ultra.neutral-thinking::before {
  content: '💭';
  position: absolute;
  top: -18px;
  left: -12px;
  animation: thinkingFloat 2s ease-in-out;
  font-size: 1.3rem;
}

.adventure-effects-ultra.neutral-focus::before {
  content: '🎯';
  position: absolute;
  top: -10px;
  right: -10px;
  animation: focusGlow 1s ease-in-out;
  font-size: 1.1rem;
}

/* Animations des effets */
@keyframes sparkleEffect {
  0% { opacity: 0; transform: translateY(0) scale(0.5); }
  50% { opacity: 1; transform: translateY(-10px) scale(1.2); }
  100% { opacity: 0; transform: translateY(-20px) scale(0.8); }
}

@keyframes starBurst {
  0% { opacity: 0; transform: scale(0) rotate(0deg); }
  50% { opacity: 1; transform: scale(1.3) rotate(180deg); }
  100% { opacity: 0; transform: scale(0.7) rotate(360deg); }
}

@keyframes celebrationPop {
  0% { opacity: 0; transform: translateX(-50%) scale(0); }
  20% { opacity: 1; transform: translateX(-50%) scale(1.4); }
  40% { opacity: 1; transform: translateX(-50%) scale(1.1); }
  60% { opacity: 1; transform: translateX(-50%) scale(1.3); }
  80% { opacity: 1; transform: translateX(-50%) scale(1); }
  100% { opacity: 0; transform: translateX(-50%) scale(0.8); }
}

@keyframes lightningStrike {
  0%, 20%, 40%, 60%, 80%, 100% { opacity: 0; }
  10%, 30%, 50%, 70%, 90% { opacity: 1; }
}

@keyframes sweatDrop {
  0% { opacity: 0; transform: translateY(-5px); }
  50% { opacity: 1; transform: translateY(0); }
  100% { opacity: 0; transform: translateY(15px); }
}

@keyframes confusionSpin {
  0% { opacity: 0; transform: rotate(0deg) scale(0.8); }
  50% { opacity: 1; transform: rotate(180deg) scale(1.2); }
  100% { opacity: 0; transform: rotate(360deg) scale(0.9); }
}

@keyframes stressShake {
  0%, 100% { transform: translateX(-50%) translateY(0); }
  25% { transform: translateX(-50%) translateY(-3px) translateX(-2px); }
  75% { transform: translateX(-50%) translateY(-3px) translateX(2px); }
}

@keyframes tiredSway {
  0%, 100% { transform: rotate(0deg); opacity: 0.8; }
  50% { transform: rotate(-5deg); opacity: 1; }
}

@keyframes thinkingFloat {
  0%, 100% { opacity: 0.6; transform: translateY(0); }
  50% { opacity: 1; transform: translateY(-8px); }
}

@keyframes focusGlow {
  0%, 100% { opacity: 0.7; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.2); }
}