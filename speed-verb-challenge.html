<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Verb Challenge</title>
    <style>
        body {
            background-image: url('D:/grammar games/images/background.jpg'); /* Chemin vers l'image de fond */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            font-family: 'Open Sans', sans-serif;
            color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }

        #game-container {
            background-color: rgba(0, 0, 0, 0.8);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.7);
        }

        #timer, #score {
            font-size: 2em;
            margin-bottom: 20px;
        }

        #difficulty {
            font-size: 1.5em;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .verb-input {
            padding: 15px;
            font-size: 1.2em;
            width: 300px;
            border-radius: 10px;
            border: none;
            outline: none;
            margin-bottom: 15px;
        }

        #start-button, #check-button, #skip-button {
            background-color: #4CAF50;
            color: #ffffff;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.2em;
            margin-top: 20px;
        }

        #start-button:hover, #check-button:hover, #skip-button:hover {
            background-color: #45a049;
        }

        .red-text {
            color: red;
            font-weight: bold;
        }

        #top-scores {
            position: fixed;
            top: 10px;
            left: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            font-size: 1em;
            text-align: left;
            z-index: 100;
        }

        #top-scores-list {
            list-style-type: none;
            padding: 0;
        }

        #top-scores-list li {
            margin-bottom: 5px;
        }
    </style>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- Section affichage des meilleurs scores -->
    <div id="top-scores">
        <h3>Top 5 Scores:</h3>
        <ul id="top-scores-list"></ul>
    </div>

    <!-- Section principale du jeu -->
    <div id="game-container">
        <label for="difficulty">Choose Difficulty:</label>
        <select id="difficulty">
            <option value="1">Level 1: Infinitive to Past Simple</option>
            <option value="2">Level 2: Infinitive to Past Participle</option>
            <option value="3">Level 3: Complete Random Form</option>
        </select>
        <div id="timer">90</div>
        <div id="verb-prompt">Verb: <span id="verb-display">---</span> (<span id="verb-translation" class="red-text">---</span>)</div>
        <div id="verb-forms">
            <div id="input-container"></div>
        </div>
        <button id="start-button" onclick="startGame()">Start Game</button>
        <button id="check-button" onclick="checkVerb()" disabled>Check Answer</button>
        <button id="skip-button" onclick="skipVerb()" disabled>Skip</button>
        <div id="score">Score: 0</div>
    </div>

    <script>
        // Configuration Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAm_fvXFh9Iv1EkoCJniaLkmXOelC6CRv0",
            authDomain: "english-games-41017.firebaseapp.com",
            projectId: "english-games-41017",
            storageBucket: "english-games-41017.appspot.com",
            messagingSenderId: "452279652544",
            appId: "1:452279652544:web:916f93e0ab29183e739d25",
            measurementId: "G-RMCQTMKDVP"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        // Initialize Firestore
        const db = firebase.firestore();

        // Variables globales
        let score = 0;
        let timeLeft = 90;
        let timerInterval;
        let currentVerb = "";

        // Dictionnaire des verbes avec traduction française
        const verbs = {
            "be": ["was/were", "been", "être"],
            "become": ["became", "become", "devenir"],
            "begin": ["began", "begun", "commencer"],
            "break": ["broke", "broken", "casser"],
            "bring": ["brought", "brought", "apporter"],
            "build": ["built", "built", "construire"],
            "buy": ["bought", "bought", "acheter"],
            "catch": ["caught", "caught", "attraper"],
            "choose": ["chose", "chosen", "choisir"],
            "come": ["came", "come", "venir"],
            "do": ["did", "done", "faire"],
            "drink": ["drank", "drunk", "boire"],
            "drive": ["drove", "driven", "conduire"],
            "eat": ["ate", "eaten", "manger"],
            "feel": ["felt", "felt", "ressentir"],
            "find": ["found", "found", "trouver"],
            "fly": ["flew", "flown", "voler"],
            "forget": ["forgot", "forgotten", "oublier"],
            "get": ["got", "got", "obtenir"],
            "give": ["gave", "given", "donner"],
            "go": ["went", "gone", "aller"],
            "have": ["had", "had", "avoir"],
            "hear": ["heard", "heard", "entendre"],
            "know": ["knew", "known", "connaître"],
            "leave": ["left", "left", "quitter"],
            "make": ["made", "made", "faire"],
            "meet": ["met", "met", "rencontrer"],
            "pay": ["paid", "paid", "payer"],
            "put": ["put", "put", "mettre"],
            "read": ["read", "read", "lire"],
            "run": ["ran", "run", "courir"],
            "say": ["said", "said", "dire"],
            "see": ["saw", "seen", "voir"],
            "sit": ["sat", "sat", "s'asseoir"],
            "speak": ["spoke", "spoken", "parler"],
            "take": ["took", "taken", "prendre"],
            "think": ["thought", "thought", "penser"],
            "write": ["wrote", "written", "écrire"]
        };

        // Démarrer le jeu
        function startGame() {
            score = 0;
            timeLeft = 90;
            document.getElementById("score").textContent = "Score: " + score;
            document.querySelectorAll(".verb-input").forEach(input => input.disabled = false);
            document.getElementById("start-button").disabled = true;
            document.getElementById("check-button").disabled = false;
            document.getElementById("skip-button").disabled = false;
            timerInterval = setInterval(updateTimer, 1000);
            displayVerb();
        }

        // Mettre à jour le chronomètre
        function updateTimer() {
            timeLeft--;
            document.getElementById("timer").textContent = timeLeft;
            if (timeLeft <= 0) {
                endGame();
            }
        }

        // Obtenir un verbe aléatoire
        function getRandomVerb() {
            const keys = Object.keys(verbs);
            return keys[Math.floor(Math.random() * keys.length)];
        }

        // Afficher un verbe en fonction du niveau de difficulté
        function displayVerb() {
            currentVerb = getRandomVerb();
            const difficulty = document.getElementById("difficulty").value;
            const inputContainer = document.getElementById("input-container");
            inputContainer.innerHTML = "";

            document.getElementById("verb-display").textContent = `${currentVerb}`;
            document.getElementById("verb-translation").textContent = `${verbs[currentVerb][2]}`;

            if (difficulty === "1") {
                const input = createInput("past-simple", "Past Simple:", false);
                inputContainer.appendChild(input);
            } else if (difficulty === "2") {
                const input = createInput("past-participle", "Past Participle:", false);
                inputContainer.appendChild(input);
            } else if (difficulty === "3") {
                const input1 = createInput("past-simple", "Past Simple:", false);
                const input2 = createInput("past-participle", "Past Participle:", false);
                inputContainer.appendChild(input1);
                inputContainer.appendChild(input2);
            }

            inputContainer.querySelector("input").focus();
        }

        function createInput(id, labelText, disabled) {
            const div = document.createElement("div");
            const label = document.createElement("label");
            label.setAttribute("for", id);
            label.textContent = labelText;
            const input = document.createElement("input");
            input.type = "text";
            input.id = id;
            input.className = "verb-input";
            input.placeholder = `Type ${labelText.toLowerCase()}`;
            input.disabled = disabled;
            div.appendChild(label);
            div.appendChild(input);
            return div;
        }

        // Vérifier les réponses
        function checkVerb() {
            const pastSimpleInput = document.getElementById("past-simple") ? document.getElementById("past-simple").value.trim() : "";
            const pastParticipleInput = document.getElementById("past-participle") ? document.getElementById("past-participle").value.trim() : "";
            const correctForms = verbs[currentVerb];

            let isCorrect = true;
            if (pastSimpleInput && pastSimpleInput.toLowerCase() !== correctForms[0].toLowerCase()) {
                isCorrect = false;
            }
            if (pastParticipleInput && pastParticipleInput.toLowerCase() !== correctForms[1].toLowerCase()) {
                isCorrect = false;
            }

            if (isCorrect) {
                score++;
                document.getElementById("score").textContent = "Score: " + score;
                displayVerb();
            } else {
                alert(`Incorrect! Correct answers are: Past Simple: ${correctForms[0]}, Past Participle: ${correctForms[1]}`);
            }
        }

        function skipVerb() {
            displayVerb();
        }

        function endGame() {
            clearInterval(timerInterval);
            document.querySelectorAll(".verb-input").forEach(input => input.disabled = true);
            document.getElementById("start-button").disabled = false;
            document.getElementById("check-button").disabled = true;
            document.getElementById("skip-button").disabled = true;
            alert("Game Over! Your final score is: " + score);
            saveScore(score);
        }

        function saveScore(score) {
            db.collection("scores").add({
                score: score,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            })
            .then(() => {
                loadTopScores();
            })
            .catch((error) => {
                console.error("Error saving score: ", error);
            });
        }

        function loadTopScores() {
            db.collection("scores")
                .orderBy("score", "desc")
                .limit(5)
                .get()
                .then((querySnapshot) => {
                    const topScoresList = document.getElementById("top-scores-list");
                    topScoresList.innerHTML = "";
                    querySnapshot.forEach((doc) => {
                        const li = document.createElement("li");
                        li.textContent = doc.data().score;
                        topScoresList.appendChild(li);
                    });
                })
                .catch((error) => {
                    console.error("Error loading top scores: ", error);
                });
        }

        document.addEventListener('DOMContentLoaded', (event) => {
            loadTopScores();
        });
    </script>
</body>
</html>
